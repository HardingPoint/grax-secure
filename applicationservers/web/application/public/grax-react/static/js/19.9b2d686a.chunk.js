(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{153:function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return P});var s=a(67),n=a(10),r=a(11),o=a(14),i=a(12),l=a(13),c=a(1),u=a.n(c),p=a(51),d=a(102),h=a(73),m=a(61),g=a(79),f=a(83),y=a(54),b=a(5),v=a(8),C=a.n(v),x=a(138),P=function(t){function e(t){var a;return Object(n.a)(this,e),(a=Object(o.a)(this,Object(i.a)(e).call(this,t))).state={sortColumn:"Id",sortDirection:"asc",chunks:[],items:[],extraInfo:{},page:0,selection:[],isLoaded:!1,isLoading:!1},a}return Object(l.a)(e,t),Object(r.a)(e,[{key:"shouldComponentUpdate",value:function(t,e){return this.props.renderKey!==t.renderKey||this.state.items!==e.items||this.state.selection!==e.selection||this.state.isLoaded!==e.isLoaded||this.state.isLoading!==e.isLoading||this.state.sortColumn!==e.sortColumn||this.state.sortDirection!==e.sortDirection||this.props.columns!==t.columns}},{key:"getDataHandler",value:function(t,e,a){this.setState({isLoading:!0,page:t,sortColumn:e,sortDirection:a}),y.a.ajax({type:"GET",url:y.c+"/grax-app/grax-data-lake"+Object(y.b)({action:"load",dataIndex:this.props.dataIndex,_select:C.a.union(this.props.columns,this.props.hiddenColumns).join(",")||"Id",_q:this.props.filterQuery,_limit:100,_from:100*t,_sort:e+" "+a,_sortType:this.getSortFieldType(e)}),success:function(t){var e=t.results;this.props.filterFunction&&(e=this.props.filterFunction(e)),e=C.a.map(e,function(t,e){return C.a.forEach(t,function(e,a){if("string"==typeof e&&b.c.test(e)){var s=Object(b.i)(e);s.isValid()&&(t[a]=s.tz(b.d).format(-1!==s._i.indexOf(":")?b.a:b.b))}Object(x.isArray)(e)&&(t[a]=e.join(", ")),"boolean"==typeof e&&(t[a]=e?"true":"false")}),Object(s.a)({},t,{id:e.toString()})}),this.setState({page:0,data:e,extraInfo:t.extraInfo||{total:0,size:100,totalRetrieved:0},items:e,isLoaded:!0,isLoading:!1})}.bind(this),error:function(t,e,a){console.error(t,e,a),this.setState({isLoaded:!0,isLoading:!1,items:[],error:a.toString()})}.bind(this)})}},{key:"componentDidMount",value:function(){this.getDataHandler(0,this.state.sortColumn,this.state.sortDirection)}},{key:"handleChanged",value:function(t,e){this.setState({selection:e.selection}),console.log(t,e)}},{key:"handleSort",value:function(t){t.property&&this.getDataHandler(this.state.page,t.property,t.sortDirection)}},{key:"getSortFieldType",value:function(t){return this.props._graxFieldsSelection?(this.props._graxFieldsSelection.find(function(e){return e.id===t})||{}).type:null}},{key:"render",value:function(){var t=this;return this.state.isLoaded?u.a.createElement("div",null,u.a.createElement("div",{style:{position:"relative"}},this.state.isLoading&&u.a.createElement(p.a,{size:"large",variant:"brand"}),u.a.createElement(d.a,{assistiveText:{actionsHeader:"actions",columnSort:"sort this column",columnSortedAscending:"asc",columnSortedDescending:"desc",selectAllRows:"all rows",selectRow:"select this row"},fixedLayout:!0,items:this.state.items,id:"GRAXRestoreDataTable",onRowChange:this.handleChanged.bind(this),onSort:this.handleSort.bind(this),selection:this.state.selection,selectRows:!0},this.props.columns.map(function(e){return u.a.createElement(h.a,{key:"col"+e,id:e,isSorted:t.state.sortColumn===e,label:e,property:e,sortable:null==t.props.sortableColumns||-1!==t.props.sortableColumns.indexOf(e),sortDirection:t.state.sortDirection})}))),u.a.createElement("div",{className:"-x-small-buttons--horizontal slds-p-top_small"},u.a.createElement(g.a,{totalItems:this.state.items.length>0?this.state.extraInfo.total:0,pageSize:100,onChangePage:function(e,a){a||t.getDataHandler(e-1,t.state.sortColumn,t.state.sortDirection)}})),u.a.createElement("div",{className:"-x-small-buttons--horizontal slds-p-top_medium"},u.a.createElement(m.a,{label:"Restore Selection",disabled:this.state.selection.length<1||this.state.isLoading,onClick:function(){confirm("Are you sure that you want to re-create the selected records?")&&(y.a.ajax({type:"POST",url:y.c+"/grax-app/grax-data-lake"+Object(y.b)({action:"restore",restoreChildrens:t.props.restoreChildrens,sfRequestsDisabled:t.props.sfRequestsDisabled,checkIsUserActive:t.props.checkIsUserActive,useGRAXHistoryOnly:t.props.useGRAXHistoryOnly,updateRecordIfExist:t.props.updateRecordIfExist,sendNotification:t.props.sendNotification}),contentType:"application/json; charset=utf-8",data:JSON.stringify(C.a.map(t.state.selection,function(t){return C.a.omit(t,["id"])})),success:function(t){alert(t.state)}}),t.setState({selection:[]}))}}),u.a.createElement(m.a,{label:"Restore All",disabled:this.state.isLoading,onClick:function(){confirm("Are you sure that you want to re-create the filtered records?")&&(y.a.ajax({type:"POST",url:y.c+"/grax-app/grax-data-lake/restoreAll"+Object(y.b)({action:"restore",restoreChildrens:t.props.restoreChildrens,sfRequestsDisabled:t.props.sfRequestsDisabled,checkIsUserActive:t.props.checkIsUserActive,useGRAXHistoryOnly:t.props.useGRAXHistoryOnly,updateRecordIfExist:t.props.updateRecordIfExist,sendNotification:t.props.sendNotification}),contentType:"application/json; charset=utf-8",data:JSON.stringify({dataIndex:t.props.dataIndex,_q:t.props.filterQuery,_sort:t.state.sortColumn+" "+t.state.sortDirection,_sortType:t.getSortFieldType(t.state.sortColumn)}),success:function(t){alert(t.state)}}),t.setState({selection:[]}))}}),u.a.createElement(f.a,{params:{source:"elastic",dataIndex:this.props.dataIndex,_select:C.a.union(this.props.columns,this.props.hiddenColumns).join(","),_q:this.props.filterQuery,_sort:this.state.sortColumn+" "+this.state.sortDirection,_sortType:this.getSortFieldType(this.state.sortColumn),columns:this.props.columns}}))):u.a.createElement("div",{style:{position:"relative",height:"2rem"}},u.a.createElement(p.a,{size:"medium",variant:"brand"}))}}]),e}(u.a.Component)},79:function(t,e,a){"use strict";var s=a(59),n=a(10),r=a(11),o=a(14),i=a(12),l=a(13),c=a(1),u=a.n(c),p=a(105),d=a(61),h=a(118),m=function(t){function e(t){var a;return Object(n.a)(this,e),(a=Object(o.a)(this,Object(i.a)(e).call(this,t))).state={pager:{}},a}return Object(l.a)(e,t),Object(r.a)(e,[{key:"componentWillMount",value:function(){this.props.totalItems&&this.setPage(this.props.currentPage,!0)}},{key:"setPage",value:function(t,e){var a=this.props,s=a.totalItems,n=a.pageSize,r=this.state.pager;t<1||t>r.totalPages||(r=this.getPager(s,t,n),this.setState({pager:r}),this.props.onChangePage(t,e))}},{key:"getPager",value:function(t,e,a){e=e||1,a=a||10;var n=!1;t>1e4&&(t=1e4,n=!0);var r,o,i=Math.ceil(t/a);i<=10?(r=1,o=i):e<=6?(r=1,o=10):n&&e+3>=i?(r=i-8,o=i):e+4>=i?(r=i-9,o=i):(r=e-5,o=e+4);var l=(e-1)*a,c=Math.min(l+a-1,t-1),u=Object(s.a)(Array(o+1-r).keys()).map(function(t){return r+t});return{totalItems:t,currentPage:e,pageSize:a,totalPages:i,startPage:r,endPage:o,startIndex:l,endIndex:c,pages:u,isNarrow:n}}},{key:"render",value:function(){var t=this,e=this.state.pager;return!e.pages||e.pages.length<=1?null:u.a.createElement(p.a,null,u.a.createElement(d.a,{iconCategory:"utility",iconName:"left",iconPosition:"left",label:"First",variant:"neutral",onClick:function(){return t.setPage(1)},disabled:1===e.currentPage}),u.a.createElement(d.a,{iconCategory:"utility",iconName:"chevronleft",iconPosition:"left",variant:"neutral",onClick:function(){return t.setPage(e.currentPage-1)},disabled:1===e.currentPage}),e.pages.map(function(a,s){return u.a.createElement(d.a,{key:"SLDSPaginator"+Date.now()+s,label:a,variant:e.currentPage===a?"brand":"neutral",onClick:function(){return t.setPage(a)}})}),e.isNarrow&&e.currentPage>=e.totalPages-3&&u.a.createElement(h.a,{align:"top right",content:"The list is too long, try adding more filters to optimize the results."},u.a.createElement(d.a,{label:"\xb7\xb7\xb7",variant:"neutral"})),u.a.createElement(d.a,{iconCategory:"utility",iconName:"chevronright",iconPosition:"right",variant:"neutral",onClick:function(){return t.setPage(e.currentPage+1)},disabled:e.currentPage===e.totalPages}),u.a.createElement(d.a,{iconCategory:"utility",iconName:"right",iconPosition:"right",label:"Last",variant:"neutral",onClick:function(){return t.setPage(e.totalPages)},disabled:e.currentPage===e.totalPages}))}}]),e}(u.a.Component);m.defaultProps={currentPage:1,pageSize:10},e.a=m},83:function(t,e,a){"use strict";a.d(e,"a",function(){return y});var s=a(10),n=a(11),r=a(14),o=a(12),i=a(13),l=a(1),c=a.n(l),u=a(16),p=a.n(u),d=a(8),h=a.n(d),m=a(54),g=document.getElementById("portals"),f=function(t){function e(t){return Object(s.a)(this,e),Object(r.a)(this,Object(o.a)(e).call(this,t))}return Object(i.a)(e,t),Object(n.a)(e,[{key:"render",value:function(){return p.a.createPortal(c.a.createElement("form",{id:this.props.formId,action:m.c+"/grax-app/grax-data-lake/export/"+this.props.params.source+"/csv"+Object(m.b)({action:"export",token:m.g,orgid:m.e}),target:"_blank",method:"POST",encType:"application/x-www-form-urlencoded",style:{margin:0,padding:0,border:0,display:"inline-block"}},h.a.map(this.props.params,function(t,e){return c.a.createElement("input",{type:"hidden",key:String(Date.now())+e,name:e,value:t||""})})),g)}}]),e}(c.a.Component),y=function(t){function e(t){var a;return Object(s.a)(this,e),(a=Object(r.a)(this,Object(o.a)(e).call(this,t))).state={formId:"csvExport"+Date.now()},a}return Object(i.a)(e,t),Object(n.a)(e,[{key:"render",value:function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement(f,{formId:this.state.formId,params:this.props.params}),c.a.createElement("button",{className:"slds-button slds-button_neutral",type:"submit",form:this.state.formId},"Export to CSV"))}}]),e}(c.a.Component)}}]);
//# sourceMappingURL=19.9b2d686a.chunk.js.map