(this.webpackJsonpgraxreact=this.webpackJsonpgraxreact||[]).push([[2],{280:function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"f",(function(){return i})),a.d(t,"d",(function(){return l})),a.d(t,"e",(function(){return d})),a.d(t,"b",(function(){return c}));var s=a(281),r=a.n(s);a.d(t,"a",(function(){return r.a}));var n="",i=window.__grax__.token,o=window.__grax__._csrf,l=window.__grax__.orgid,d=(window.__grax__.userid,window.__grax__.pageParams||{});function c(e){return null!==e&&void 0!==e||(e={}),null!==e.action&&void 0!==e.action&&""!==e.action||(e.action="load"),"?"+r.a.param(e)}r.a.ajaxSetup({beforeSend:function(e,t){var a;e.setRequestHeader("sfdcorgid",l),null!=d.authorization?e.setRequestHeader("Authorization","Basic "+d.authorization):e.setRequestHeader("Authorization","Bearer "+i),a=t.type,/^(GET|HEAD|OPTIONS|TRACE)$/.test(a)||this.crossDomain||e.setRequestHeader("X-CSRFToken",o),e.withCredentials=!0,!0!==t.skipFail&&e.fail((function(e,t,a){console.error(e),404!==e.status&&"Not Found"!==a&&window.showError(e.statusText+": "+e.responseText)}))}})},282:function(e,t,a){"use strict";var s=a(36),r=a(42),n=a(86),i=a(43),o=a(44),l=a(0),d=a.n(l),c=a(10),u=function(e){Object(i.a)(a,e);var t=Object(o.a)(a);function a(e){var r;Object(s.a)(this,a),r=t.call(this,e);var i=e.isOpen,o=e.isCollapsible;return r.state={isOpen:!0===i||void 0===o},r.handleToggle=r.handleToggle.bind(Object(n.a)(r)),r}return Object(r.a)(a,[{key:"handleToggle",value:function(e){var t=this.props.onToggle;this.setState((function(e){return{isOpen:!e.isOpen}})),t&&t(isOpen),e.preventDefault()}},{key:"render",value:function(){var e=this.props,t=e.id,a=e.key,s=e.isCollapsible,r=e.title,n=e.helpText,i=e.className,o=e.children,l=this.state.isOpen,u=d.a.createElement("span",{className:"slds-truncate".concat(s?"":" slds-p-horizontal_small"),title:r},r,n);return d.a.createElement("div",{id:t||a,className:["slds-section",l&&"slds-is-open",i].join(" ")},d.a.createElement("h3",{className:"slds-section__title slds-theme_shade"},s?d.a.createElement("button",{type:"button",className:"slds-button slds-section__title-action",onClick:this.handleToggle},d.a.createElement(c.a,{assistiveText:{label:r},category:"utility",name:"switch",size:"x-small",className:"slds-section__title-action-icon slds-button__icon slds-button__icon_left"}),u):u),l&&d.a.createElement("div",{className:"slds-section__content"},o))}}]),a}(d.a.Component);t.a=u},284:function(e,t,a){"use strict";var s=a(3),r=a(0),n=a.n(r),i=a(301),o=a(21);t.a=function(e){var t=Object(r.useState)(!0),a=Object(s.a)(t,2),l=a[0],d=a[1];return n.a.createElement("div",{className:"slds-is-relative"},n.a.createElement(i.a,Object.assign({formatter:o.g,parser:o.h},e,{onChange:function(t,a){d(""===a.formattedDate||Object(o.m)(a.date).isValid()),null!=e.onChange&&e.onChange(t,a)}})),!1===l?n.a.createElement("div",{className:"slds-text-color_error"},"The date is invalid. Please select/write a valid date."):null)}},288:function(e,t,a){"use strict";var s=a(281);!function(e){var t="http://www.w3.org/2000/svg";e.fn.sldsTree=function(a){var s=e.extend(!0,{data:[],items:{id:"id",label:"label",childs:"childs"},attrs:{root:{class:"slds-tree_container"},ul:{class:"slds-tree"},li:{role:"treeitem","aria-level":"1","aria-expanded":"false"},div:{class:"slds-tree__item"},button:{class:"slds-button slds-button_icon slds-m-right_x-small","aria-hidden":"true",tabindex:"-1"}},expandButton:{disabled:"slds-is-disabled"},expandIcon:{class:"slds-button__icon slds-button__icon_small",path:"./assets/icons/utility-sprite/svg/symbols.svg#chevronright"},onUl:function(e,t,a){},onLi:function(e,t,a){},onDiv:function(e,t,a){e.append(t[a.items.label])},onButton:function(e,t,a){},onFinish:function(e,t,a){}},a),r=function(a,r,n,i){var o=e("<div>").attr(s.attrs.div);return o.append(function(a,r,n){var i=e("<button>").attr(s.attrs.button).toggleClass(s.expandButton.disabled,r),o=document.createElementNS(t,"svg");o.setAttribute("class",s.expandIcon.class),o.setAttribute("aria-hidden","true");var l=document.createElementNS(t,"use");return l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",s.expandIcon.path),o.appendChild(l),i.append(o),i.on("click",(function(e){n.attr("aria-expanded",(function(e,t){return!("true"===t)})),e.preventDefault()})),s.onButton(i,a,s),i}(a,!a[s.items.childs]||a[s.items.childs].length<1,i)),s.onDiv(o,a,s),o},n=function(t,a,n){var o=e("<li>").attr(s.attrs.li);return o.attr({"aria-level":a}).append(r(t,0,0,o)),t[s.items.childs]&&o.append(i(t[s.items.childs],a+1)),s.onLi(o,t,s),o},i=function(t,a){var r=e("<ul>").attr(s.attrs.ul);return a>1&&r.attr({role:"group"}),e.each(t,(function(e,t){r.append(n(t,a))})),s.onUl(r,t,s),r};return this.attr(s.attrs.root).html(i(s.data,1)),s.onFinish(this,s.data,s),this}}(a.n(s).a)},290:function(e,t){var a=["grax_data_record__c","grax__grax_data_record__c"];e.exports={isObjectExcludedFromSummary:function(e){return-1!==a.indexOf(e.toLowerCase())}}},291:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var s=a(88),r=a(53),n=a(36),i=a(42),o=a(43),l=a(44),d=a(0),c=a.n(d),u=a(282),m=a(75),h=a(269),p=a(72),f=a(21),g=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var s;Object(n.a)(this,a);var r=(s=t.call(this,e)).props.fromDate?s.props.fromDate:new Date,i=s.props.toDate?s.props.toDate:new Date;r.setHours(0),r.setMinutes(0),i.setHours(23),i.setMinutes(59);var o=[{label:"Object Top Ten",id:"chartObjectTopTen",call:function(){return s.chartObjectTopTen()}},{label:"Objects By Date",id:"chartObjectByDate",call:function(){return s.chartObjectByDate()}},{label:"Top Ten Processes",id:"chartSummaryTopTen",call:function(){return s.chartSummaryTopTen()}},{label:"Processes By Date",id:"chartSummaryByDate",call:function(){return s.chartSummaryByDate()}},{label:"Results by Date",id:"chartAttributeProgressByDate",call:function(){return s.chartAttributeProgressByDate()}}];return s.state={isLoading:!0,summaryData:s.props.summaryData,defaultChartSettings:{width:"100%",height:600,chartArea:{width:"70%",left:"5%"}},showChartAttr:{showRecords:!0,showInserted:!0,showUpdated:!0,showArchived:!0},chartFromDate:r,chartToDate:i,showAttributeFilter:!0,hideChartOptions:!1,chartOptions:o,chartSelection:[o[0]]},s}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;google.charts.setOnLoadCallback((function(){e.setState({isLoading:!1},(function(){e.drawChart()}))}))}},{key:"chartObjectTopTen",value:function(){var e,t=this.state.summaryData,a=0,n={},i=[],o=[],l=0,d=new Set;t.forEach((function(e){for(var t in e.summaryMap)d.add(t)})),(e=Object(s.a)(Array,Object(r.a)(d))).sort((function(e,t){return e>t?-1:e<t?1:0})),e.forEach((function(e){n[e]=l,l++})),l=0,t.forEach((function(e){for(var t in e.summaryMap){var s=e.summaryMap[t],r=i[t],n=s.records?s.records:0;if(r||0===r){var d=o[r][1]+n;o[r]=[t+" ["+d+"]",d]}else r=l,i[t]=l,o.push([t+" ["+n+"]",n]),l++;a+=n}})),o.sort((function(e,t){return-e[1]+t[1]}));for(var c=[["Object","Backed Up"]],u=0;u<10&&u<o.length;u++){var m=o[u];c.push(m),a-=m[1]}a>0&&c.push(["Others ["+a+"]",a]);var h=google.visualization.arrayToDataTable(c),p=JSON.parse(JSON.stringify(this.state.defaultChartSettings));return p.sliceVisibilityThreshold=0,[google.visualization.PieChart,h,p]}},{key:"chartObjectByDate",value:function(){var e=this,t=this.state.summaryData,a=[],n=[],i={},o=new google.visualization.DataTable;o.addColumn("date","Start Time");var l,d,c,u=0,m=new Set;t.forEach((function(e){for(var t in e.summaryMap)m.add(t)})),(l=Object(s.a)(Array,Object(r.a)(m))).sort((function(e,t){return e>t?-1:e<t?1:0})),l.forEach((function(e){i[e]=u,u++})),u=0;var h={};if(t.forEach((function(t){for(var s in t.summaryMap){var r=t.summaryMap[s];if(r.startTime){var o=r.records?r.records:0,m=new Date(r.startTime),p=e.formatStartTime(m),f=n[m];(!d||d>=m)&&(d=new Date(m)).setHours(d.getHours()-1),(!c||c<=m)&&(c=new Date(m)).setHours(c.getHours()+1),f||0===f||(f=u,n[m]=u,a.push(new Array(l.length+1).fill(void 0)),u++),a[f][0]={v:m,f:p},a[f][i[s]+1]||(a[f][i[s]+1]=0),a[f][i[s]+1]+=o,h[s]||(h[s]=0),h[s]+=o}}})),0===a.length)return null;for(var p in i)o.addColumn("number",p+" ["+h[p]+"]");a.sort((function(e,t){return e[0].v>t[0].v?1:e[0].v<t[0].v?-1:0})),o.addRows(a);var f=JSON.parse(JSON.stringify(this.state.defaultChartSettings));return f.interpolateNulls=!0,f.pointSize=5,f.explorer={},f.hAxis={title:"Start Time",format:"YYYY-dd-MM\nhh:mm:ss",viewWindow:{min:d,max:c},viewWindowMode:"maximized"},f.vAxis={title:"Backed up objects"},[google.visualization.LineChart,o,f]}},{key:"chartSummaryTopTen",value:function(){var e,t=this.state.summaryData,a=0,n={},i=[],o=[],l=0,d=new Set;t.forEach((function(e){d.add(e.spName)})),(e=Object(s.a)(Array,Object(r.a)(d))).sort((function(e,t){return e>t?-1:e<t?1:0})),e.forEach((function(e){n[e]=l,l++})),l=0,t.forEach((function(e){var t=i[e.spName],s=e.summaryResults.records?e.summaryResults.records:0;if(t||0===t){var r=o[t][1]+s;o[t]=[e.spName+" ["+r+"]",r]}else o.push([e.spName+" ["+s+"]",s]);a+=s})),o.sort((function(e,t){return-e[1]+t[1]}));for(var c=[["Summary","Backed Up"]],u=0;u<10&&u<o.length;u++){var m=o[u];c.push(m),a-=m[1]}a>0&&c.push(["Others ["+a+"]",a]);var h=google.visualization.arrayToDataTable(c),p=JSON.parse(JSON.stringify(this.state.defaultChartSettings));return p.sliceVisibilityThreshold=0,[google.visualization.PieChart,h,p]}},{key:"chartSummaryByDate",value:function(){var e=this,t=this.state.summaryData,a=[],n=[],i={},o=new google.visualization.DataTable;o.addColumn("date","Start Time");var l,d,c,u=0,m=new Set;t.forEach((function(e){m.add(e.spName)})),(l=Object(s.a)(Array,Object(r.a)(m))).sort((function(e,t){return e>t?-1:e<t?1:0})),l.forEach((function(e){i[e]=u,u++})),u=0;var h={};if(t.forEach((function(t){var s=t.summaryResults;if(s.startTime){var r=s.records?s.records:0,o=new Date(s.startTime),m=e.formatStartTime(o),p=n[o];(!d||d>=o)&&(d=new Date(o)).setHours(d.getHours()-1),(!c||c<=o)&&(c=new Date(o)).setHours(c.getHours()+1),p||0===p||(p=u,n[o]=u,a.push(new Array(l.length+1).fill(void 0)),u++),a[p][0]={v:o,f:m},a[p][i[t.spName]+1]||(a[p][i[t.spName]+1]=0),a[p][i[t.spName]+1]+=r,h[t.spName]||(h[t.spName]=0),h[t.spName]+=r}})),0===a.length)return null;for(var p in i)o.addColumn("number",p+" ["+h[p]+"]");a.sort((function(e,t){return e[0].v>t[0].v?1:e[0].v<t[0].v?-1:0})),o.addRows(a);var f=JSON.parse(JSON.stringify(this.state.defaultChartSettings));return f.interpolateNulls=!0,f.explorer={},f.hAxis={title:"Start Time",format:"YYYY-dd-MM\nhh:mm:ss",viewWindow:{min:d,max:c},viewWindowMode:"maximized"},f.vAxis={title:"Backed up objects"},[google.visualization.LineChart,o,f]}},{key:"chartAttributeProgressByDate",value:function(){var e=this.state.summaryData,t=[],a=[],s={},r=new google.visualization.DataTable;r.addColumn("date","Start Time");var n,i,o=0,l=[],d=[];this.state.showChartAttr.showRecords&&d.push("records"),this.state.showChartAttr.showInserted&&d.push("inserted"),this.state.showChartAttr.showUpdated&&d.push("updated"),this.state.showChartAttr.showArchived&&d.push("archived"),d.forEach((function(e){l.push(e)})),l.sort((function(e,t){return e<t?-1:e>t?1:0})),l.forEach((function(e){s[e]=o,o++})),o=0;var c={},u=new Set;if(e.forEach((function(e){var r={},l=e.summaryMap,m=!1,h=function(e){var t=l[e];t&&(d.forEach((function(e){r[e]=r[e]?r[e]:0,r[e]+=t[e]?t[e]:0})),m=!0)};for(var p in l)h(p);if(m&&e.summaryResults.startTime){var f=new Date(e.summaryResults.startTime);f.setSeconds(0);var g=f,v=f.getFullYear()+"-"+(f.getMonth()+1).toString().padStart(2,"0")+"-"+f.getDate().toString().padStart(2,"0")+" "+f.getHours().toString().padStart(2,"0")+":"+f.getMinutes().toString().padStart(2,"0")+":"+f.getSeconds().toString().padStart(2,"0"),y=a[g];(!n||n>=g)&&(n=new Date(g)).setHours(n.getHours()-1),(!i||i<=g)&&(i=new Date(g)).setHours(i.getHours()+1),y||0===y||(y=o,a[g]=o,t.push(new Array(d.length+1).fill(void 0)),o++),t[y][0]={v:g,f:v+"\n"+e.spName},d.forEach((function(e){t[y][s[e]+1]||(t[y][s[e]+1]=0),t[y][s[e]+1]+=r[e],c[e]||(c[e]=0),c[e]+=r[e]})),u.add(e.spName)}})),0===t.length)return null;for(var m in s)void 0!==c[m]&&r.addColumn("number",m+" ["+c[m]+"]");t.sort((function(e,t){return e[0]>t[0]?1:e[0]<t[0]?-1:0})),r.addRows(t);var h=JSON.parse(JSON.stringify(this.state.defaultChartSettings));return h.interpolateNulls=!0,h.isStacked=!0,h.explorer={},h.hAxis={title:"Start Date",format:"YYYY-dd-MM\n hh:mm:ss",viewWindowMode:"pretty",viewWindow:{min:n,max:i}},h.vAxis={title:"Attributes"},[google.visualization.ColumnChart,r,h]}},{key:"drawChart",value:function(){var e=this,t=this.state.chartSelection[0].call();this.setState({isLoading:!1,isBlank:null==t},(function(){t&&new t[0](e.chartEl).draw(t[1],t[2])}))}},{key:"selectChart",value:function(e){this.setState({chartInput:"",chartSelection:e},this.drawChart)}},{key:"setDateFilter",value:function(e,t){this.setState({chartFromDate:e,chartToDate:t})}},{key:"formatStartTime",value:function(e){return e.getFullYear()+"-"+(e.getMonth()+1).toString().padStart(2,"0")+"-"+e.getDate().toString().padStart(2,"0")+" "+e.getHours().toString().padStart(2,"0")+":"+e.getMinutes().toString().padStart(2,"0")+":"+e.getSeconds().toString().padStart(2,"0")}},{key:"formatDate",value:function(e){return e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear()}},{key:"render",value:function(){var e=this;return this.state.isLoading?c.a.createElement(m.a,{size:"large",variant:"brand"}):c.a.createElement("div",null,c.a.createElement("div",null,!this.state.hideChartOptions&&c.a.createElement("div",{className:"slds-grid slds-wrap"},c.a.createElement("div",{className:"slds-col slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1"},c.a.createElement(u.a,{title:"Chart Options",isCollapsible:"true"},c.a.createElement("div",{className:"slds-grid slds-wrap"},c.a.createElement("div",{className:"chartAttributeProgressByDate"===this.state.chartSelection[0].id&&this.state.showAttributeFilter?"slds-col slds-size_1-of-2 slds-medium-size_1-of-2 slds-large-size_1-of-2":"slds-col slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1"},c.a.createElement(h.a,{events:{onChange:function(t,a){var s=a.value;e.chartInput=s,e.setState({chartInput:s},e.drawChart)},onRequestRemoveSelectedOption:function(t,a){e.setState({chartInput:"",chartSelection:a.selection})},onSelect:function(t,a){e.selectChart(a.selection),e.props.onChartSelect&&e.props.onChartSelect(t,a.selection)}},labels:{label:"Chart Type",placeholder:"-- SELECT CHART TYPE --"},options:Object(f.f)({inputValue:this.state.chartInput,limit:1e3,options:this.state.chartOptions,selection:this.state.chartSelection}),selection:this.state.chartSelection,value:this.state.chartInput,variant:"readonly"})),"chartAttributeProgressByDate"===this.state.chartSelection[0].id&&this.state.showAttributeFilter&&c.a.createElement("div",{className:"slds-col slds-size_1-of-2 slds-medium-size_1-of-2 slds-large-size_1-of-2"},c.a.createElement(u.a,{title:"Display Values",className:"slds-p-left_small slds-m-top_none"},c.a.createElement("div",{className:"slds-grid slds-wrap"},c.a.createElement("div",{className:"slds-align_absolute-center slds-m-bottom_small slds-col slds-size_1-of-2 slds-medium-size_1-of-4 slds-large-size_1-of-4 slds-x-large-size_1-of-4"},c.a.createElement(p.a,{className:"inline-block",defaultChecked:this.state.showChartAttr.showRecords,onChange:function(t){var a=e.state.showChartAttr;a.showRecords=t,e.setState({showChartAttr:a,isLoading:!1},(function(){return e.drawChart()}))},assistiveText:{label:"Remove empty?"},variant:"toggle",labels:{toggleDisabled:"Records",toggleEnabled:"Records"}})),c.a.createElement("div",{className:"slds-align_absolute-center slds-m-bottom_small slds-col slds-size_1-of-2 slds-medium-size_1-of-4 slds-large-size_1-of-4 slds-x-large-size_1-of-4"},c.a.createElement(p.a,{className:"inline-block",defaultChecked:this.state.showChartAttr.showInserted,onChange:function(t){var a=e.state.showChartAttr;a.showInserted=t,e.setState({showChartAttr:a,isLoading:!1},(function(){return e.drawChart()}))},assistiveText:{label:"Remove empty?"},variant:"toggle",labels:{toggleDisabled:"Inserted",toggleEnabled:"Inserted"}})),c.a.createElement("div",{className:"slds-align_absolute-center slds-m-bottom_small slds-col slds-size_1-of-2 slds-medium-size_1-of-4 slds-large-size_1-of-4 slds-x-large-size_1-of-4"},c.a.createElement(p.a,{className:"inline-block",defaultChecked:this.state.showChartAttr.showUpdated,onChange:function(t){var a=e.state.showChartAttr;a.showUpdated=t,e.setState({showChartAttr:a,isLoading:!1},(function(){return e.drawChart()}))},assistiveText:{label:"Remove empty?"},variant:"toggle",labels:{toggleDisabled:"Updated",toggleEnabled:"Updated"}})),c.a.createElement("div",{className:"slds-align_absolute-center slds-m-bottom_small slds-col slds-size_1-of-2 slds-medium-size_1-of-4 slds-large-size_1-of-4 slds-x-large-size_1-of-4"},c.a.createElement(p.a,{className:"inline-block",defaultChecked:this.state.showChartAttr.showArchived,onChange:function(t){var a=e.state.showChartAttr;a.showArchived=t,e.setState({showChartAttr:a,isLoading:!1},(function(){e.drawChart()}))},assistiveText:{label:"Remove empty?"},variant:"toggle",labels:{toggleDisabled:"Archived",toggleEnabled:"Archived"}}))))))))),this.state.isBlank?null:c.a.createElement("div",{ref:function(t){return e.chartEl=t}})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e}}]),a}(c.a.Component)},292:function(e,t,a){"use strict";a.d(t,"a",(function(){return x})),a.d(t,"b",(function(){return R}));var s=a(53),r=a(7),n=a(3),i=a(36),o=a(42),l=a(43),d=a(44),c=a(11),u=a(0),m=a.n(u),h=a(282),p=a(119),f=a(269),g=a(274),v=a(121),y=a(72),b=a(16),S=a(75),D=a(284),w=a(280),T=a(21),C=a(281),_=a.n(C),E=(a(288),a(290)),O=a(291),k=function(e){var t=e.children,a=Object(c.a)(e,["children"]);return m.a.createElement(p.a,a,m.a.createElement("a",{href:w.c+"/grax-app/grax-data-lake/generateBackupSummary/"+a.item.spId+"/"+encodeURI(a.item.executionUniqueKey)+"?orgid="+w.d,target:"_blank",rel:"noopener noreferrer"},t))};k.displayName=p.a.displayName;var x="record_summaries",R=function(e){Object(l.a)(a,e);var t=Object(d.a)(a);function a(e){var s;Object(i.a)(this,a),(s=t.call(this,e)).chart=m.a.createRef(),s.summaryDataResults=[],s.summaryDataSelected=[],s.itemsObjectsByDataRange=[],s.itemsObjectsByDataRangeSelection=[],s.summaryBreakdownDTItems=[],s.summaryBreakdownDTSelection=[],s.summaryDTItems=[],s.summaryDTSelection=[],s.chartOptions=[],s.defaultChartSettings={width:"100%",height:600,chartArea:{width:"70%",left:"5%"}},s.displayValuesOptions=[{id:"all",label:"Show all"},{id:"inserted",label:"Only show schedule processes that have at least 1 insert"},{id:"updated",label:"Only show schedule processes that have at least 1 update"},{id:"archived",label:"Only show schedule processes that have at least 1 archive"}];var r=[s.displayValuesOptions[0]];return s.state={isLoading:!0,renderCounter:0,chartData:[],chartSelection:[],chartInput:"",fromDate:e.filterParams.fromDate,toDate:e.filterParams.toDate,_currentOrgRecords:!0,summaryDTFilters:{showRecords:!0,showInserted:!0,showUpdated:!0,showArchived:!0},inputValue:"Select an option",selection:[],checked:[],displayValuesSelection:r,error:null},s}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.props.variant===x?this.loadSummaries():this.setState({isLoading:!1})}},{key:"loadSummaries",value:function(){var e=this;this.summaryDTSelection=[],this.summaryBreakdownDTSelection=[],this.itemsObjectsByDataRangeSelection=[],this.setState({isLoading:!0});var t=this.state.chartSelected,a=this.state.fromDate;a=a.getFullYear()+"-"+(a.getMonth()+1).toString().padStart(2,0)+"-"+a.getDate().toString().padStart(2,0);var s=this.state.toDate;s=s.getFullYear()+"-"+(s.getMonth()+1).toString().padStart(2,0)+"-"+s.getDate().toString().padStart(2,0);var r={AND:[]};a=Object(T.j)({date:a})[0],s=Object(T.j)({date:s})[1],a!==T.c&&r.AND.push({GTE:{"summaryResults.startTime":a}}),s!==T.c&&r.AND.push({LTE:{"summaryResults.startTime":s}}),this.state._currentOrgRecords&&r.AND.push({KEQ:{graxorgid:w.d}}),null!=this.props.filterParams.gspId&&r.AND.push({KEQ:{spId:this.props.filterParams.gspId}}),_.a.ajax({type:"GET",url:w.c+"/grax-app/grax-data-lake"+Object(w.b)({action:"load",dataIndex:"graxgrax_backup_summaryindex",_index:"graxgrax_backup_summaryindex,graxgrax_summaryindex",_select:"summaryMap,spName,spId,CreatedDate,summaryResults,executionUniqueKey",_q:JSON.stringify(r),_limit:1e3,_from:0,_sort:"",_sortType:"",_ignore_unavailable:!0}),success:function(a){a.results&&(e.summaryDataResults=a.results),e.setState({isLoading:!1,chartSelected:t},(function(){e.loadSummaryDataTable(),e.loadSummaryBreakdownTable(),e.loadObjectDataTable()}))},error:function(t,a,s){console.error(t,a,s),e.setState({isLoading:!1})}})}},{key:"getSelectedSummary",value:function(){this.summaryBreakdownDTSelection=this.getScheduleProcessBreakdownSelection(this.summaryBreakdownDTSelection);var e=this.summaryBreakdownDTSelection,t=this.summaryDataResults,a=[];return e.forEach((function(e){a.push(t[e.index])})),a}},{key:"loadSummaryDataTable",value:function(){var e=this.summaryDataResults,t=[];if(e){var a=Object(n.a)(this.state.displayValuesSelection,1)[0],s=void 0===a?this.displayValuesOptions[0]:a,r=0;e.forEach((function(e){var a=e.summaryResults,n=void 0===a?{}:a,i=n.records,o=void 0===i?0:i,l=n.inserted,d=void 0===l?0:l,c=n.updated,u=void 0===c?0:c,m=n.archived,h=void 0===m?0:m;if(!("archived"===s.id&&0===h||"inserted"===s.id&&0===d||"updated"===s.id&&0===u)){var p=e.spId,f=e.spName,g=e.executionUniqueKey,v=e.CreatedDate,y=t.filter((function(e){return e.name===f}));if(y&&y.length>0)y[0].index.push(r),y[0].records+=o,y[0].inserted+=d,y[0].updated+=u,y[0].archived+=h;else{var b=new Date(v),S=new Date(n.startTime);t.push({name:f,id:f,spId:p,executionUniqueKey:g,CreatedDate:v,CreatedDateFormatted:T.m.utc(b).tz(T.e).format(T.b),startTime:S,startTimeFormatted:T.m.utc(S).tz(T.e).format(T.a),records:o,inserted:d,updated:u,archived:h,index:[r]})}r++}}))}this.summaryDTItems=t,this.props.variant===x&&(this.summaryDTSelection=this.summaryDTItems)}},{key:"loadSummaryBreakdownTable",value:function(){var e=this.summaryDTSelection,t=this.summaryDataResults,a=[];e&&e.forEach((function(e){e.index.forEach((function(e){var s=t[e],r=s.summaryResults.archived,n=s.summaryResults.records,i=s.summaryResults.inserted,o=s.summaryResults.updated;r=r||0,n=n||0,i=i||0,o=o||0;var l=new Date(s.CreatedDate),d=new Date(s.summaryResults.startTime);a.push({spId:s.spId,name:s.spName,Id:s.Id,id:s.executionUniqueKey,executionUniqueKey:s.executionUniqueKey,index:e,CreatedDate:s.CreatedDate,CreatedDateFormatted:T.m.utc(l).tz(T.e).format(T.b),startTime:s.startTime,startTimeFormatted:T.m.utc(d).tz(T.e).format(T.a),records:n,inserted:i,updated:o,archived:r,objectsList:s.summaryMap?Object.keys(s.summaryMap):[]})}))})),this.summaryBreakdownDTItems=a,this.dataTableRefreshSort("DataTable_SummaryBreakdown",this.summaryBreakdownDTItems,{property:"name",sortDirection:"asc"})}},{key:"loadObjectDataTable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.getSelectedSummary(),a=[];if(t){var s={};for(var r in t.forEach((function(e){var t=e.summaryMap,a=new Date(e.summaryResults.startTime);for(var r in t)if("object"==typeof t[r]&&!Object(E.isObjectExcludedFromSummary)(r)){var n=t[r].archived,i=t[r].records,o=t[r].inserted,l=t[r].updated;n=n||0,i=i||0,o=o||0,l=l||0;var d=s[r];d||((d={}).name=r,d.id=r,d.archived=0,d.records=0,d.inserted=0,d.updated=0,d.startTimes=[]),d.archived+=n||0,d.records+=i||0,d.inserted+=o||0,d.updated+=l||0;var c=d.startTimes.indexOf(a);c<0&&(c=d.startTimes.length,d.startTimes.push({startTime:a,archived:0,records:0,inserted:0,updated:0}));var u=d.startTimes[c];u.archived+=n||0,u.records+=i||0,u.inserted+=o||0,u.updated+=l||0,s[r]=d}})),s)a.push(s[r])}this.itemsObjectsByDataRange=a,this.dataTableRefreshSort("DataTable_ObjectsInSummary",this.itemsObjectsByDataRange,{property:"name",sortDirection:"asc"}),e&&this.setState({isLoading:!1,renderCounter:this.state.renderCounter+1},this.refreshChart)}},{key:"getItemsObjectsByDataRange",value:function(){return this.loadObjectDataTable(!1),this.itemsObjectsByDataRange}},{key:"refreshChart",value:function(){var e=this,t=[],a=this.summaryDataResults,s=this.summaryBreakdownDTSelection,r=this.itemsObjectsByDataRangeSelection,n={};s.forEach((function(e){n[e.Id]=e.Id}));var i={};r.forEach((function(e){i[e.name]=e.name})),a.forEach((function(e){var a={};if(n[e.Id]){for(var s in a.summaryMap={},a.spName=e.spName,a.summaryResults={archived:0,records:0,inserted:0,update:0,startTime:e.summaryResults.startTime,endTime:e.summaryResults.endTime},e.summaryMap)if(i[s]){var r=e.summaryMap;a.summaryMap[s]=r[s],a.summaryResults.archived=r[s].archived?r[s].archived:0,a.summaryResults.records=r[s].records?r[s].records:0,a.summaryResults.inserted=r[s].inserted?r[s].inserted:0,a.summaryResults.update=r[s].update?r[s].update:0}t.push(a)}})),this.setState({isLoading:!1,renderCounter:this.state.renderCounter+1,chartData:t},(function(){e.chart.current.setDateFilter(e.state.fromDate,e.state.toDate),e.chart.current.drawChart()}))}},{key:"summaryDTHandleChanged",value:function(e,t){this.summaryDTSelection=t.selection,this.loadSummaryBreakdownTable(),this.summaryBreakdownDTHandleChanged(null,{selection:this.summaryBreakdownDTSelection}),this.setState({isLoading:!1,renderCounter:this.state.renderCounter+1})}},{key:"summaryBreakdownDTHandleChanged",value:function(e,t){this.summaryBreakdownDTSelection=this.getScheduleProcessBreakdownSelection(t.selection),this.loadObjectDataTable(),this.itemsObjectsByDataRangeHandleChanged(null,{selection:this.itemsObjectsByDataRangeSelection}),this.setState({isLoading:!1,renderCounter:this.state.renderCounter+1})}},{key:"itemsObjectsByDataRangeHandleChanged",value:function(e,t){this.itemsObjectsByDataRangeSelection=this.getObjectsSelection(t.selection),this.refreshChart(),this.setState({isLoading:!1,renderCounter:this.state.renderCounter+1})}},{key:"dataTableHandleSort",value:function(e,t,a){var s,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=a.property,o=a.sortDirection,l=(s={},Object(r.a)(s,e+"Column",i),Object(r.a)(s,e+"Direction",Object(r.a)({},i,o)),s);n&&this.dataTableSortFunction(t,i,o),this.setState(l)}},{key:"dataTableRefreshSort",value:function(e,t,a){var s=this.state[e+"Column"]||a.property,n=this.state[e+"Direction"]||Object(r.a)({},a.property,a.direction);if(null!=s&&null!=n){var i=n[s]||"asc";this.dataTableSortFunction(t,s,i)}}},{key:"dataTableSortFunction",value:function(e,t,a){e.sort((function(e,s){var r=0;return e[t]>s[t]&&(r=1),e[t]<s[t]&&(r=-1),"desc"===a&&(r*=-1),r}))}},{key:"getIsDatatableSortedColumn",value:function(e,t){return this.state[e+"Column"]===t}},{key:"formatStartTime",value:function(e){return e.getFullYear()+"-"+(e.getMonth()+1).toString().padStart(2,"0")+"-"+e.getDate().toString().padStart(2,"0")+" "+e.getHours().toString().padStart(2,"0")+":"+e.getMinutes().toString().padStart(2,"0")+":"+e.getSeconds().toString().padStart(2,"0")}},{key:"formatDate",value:function(e){return e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear()}},{key:"cleanFilterTables",value:function(){this.summaryBreakdownDTItems=[],this.summaryDTSelection=[],this.summaryBreakdownDTSelection=[],this.itemsObjectsByDataRangeSelection=[],this.itemsObjectsByDataRange=[],this.setState({chartData:[],renderCounter:this.state.renderCounter+1})}},{key:"renderAggregatedScheduleProcessSection",value:function(){var e=this;if(this.props.variant===x)return null;var t="DataTable_Summaries";return m.a.createElement(h.a,{title:"Step 1: Aggregated GRAX Schedule Process",className:"slds-p-top_large",isCollapsible:!0,isOpen:!0},m.a.createElement("div",{className:"slds-grid slds-wrap"},m.a.createElement("div",{className:"slds-col slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-p-horizontal_xx-small"},m.a.createElement(f.a,{events:{onChange:function(t,a){var s=a.value;e.displayValuesInput=s,e.setState({displayValuesInput:s})},onRequestRemoveSelectedOption:function(t,a){e.setState({displayValuesInput:"",displayValuesSelection:a.selection},(function(){e.loadSummaryDataTable(),e.loadSummaryBreakdownTable(),e.loadObjectDataTable()}))},onSelect:function(t,a){e.setState({displayValuesSelection:a.selection},(function(){e.loadSummaryDataTable(),e.loadSummaryBreakdownTable(),e.loadObjectDataTable()}))}},labels:{label:"Display Values",placeholder:"-- SELECT OPTION --"},options:Object(T.f)({inputValue:this.state.displayValuesInput,limit:1e3,options:this.displayValuesOptions,selection:this.state.displayValuesSelection}),selection:this.state.displayValuesSelection,value:this.state.displayValuesInput,variant:"readonly"})),m.a.createElement("div",{className:"slds-col slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-p-top_small"},m.a.createElement("div",{style:{height:300}},m.a.createElement(g.a,{assistiveText:{actionsHeader:"actions",columnSort:"sort this column",columnSortedAscending:"asc",columnSortedDescending:"desc",selectAllRows:"all rows",selectRow:"select this row"},fixedHeader:!0,fixedLayout:!0,items:this.summaryDTItems,id:t,selection:this.summaryDTSelection,selectRows:"checkbox",onRowChange:function(t,a){return e.summaryDTHandleChanged(t,a)},onSort:function(a){e.dataTableHandleSort(t,e.summaryDTItems,a)}},m.a.createElement(v.a,{label:"GRAX Schedule Process",sortable:!0,primaryColumn:!0,property:"name",isSorted:this.getIsDatatableSortedColumn(t,"name")}),m.a.createElement(v.a,{label:"Records",sortable:!0,property:"records",isSorted:this.getIsDatatableSortedColumn(t,"records")}),m.a.createElement(v.a,{label:"Inserted",sortable:!0,property:"inserted",isSorted:this.getIsDatatableSortedColumn(t,"inserted")}),m.a.createElement(v.a,{label:"Updated",sortable:!0,property:"updated",isSorted:this.getIsDatatableSortedColumn(t,"updated")}),m.a.createElement(v.a,{label:"Archived",sortable:!0,property:"archived",isSorted:this.getIsDatatableSortedColumn(t,"archived")}))))))}},{key:"getScheduleProcessBreakdownSelection",value:function(e,t){this.props.variant===x&&(this.summaryDTSelection=this.summaryDTItems);var a=this.summaryDTSelection,r=this.summaryBreakdownDTItems;return e.reduce((function(e,t){return void 0!==a.find((function(e){return e.name===t.name}))?[].concat(Object(s.a)(e),[r.find((function(e){return e.id===t.id}))]):e}),[])}},{key:"getSummaryBreakdownDTItems",value:function(){this.loadSummaryBreakdownTable();var e=this.summaryDTSelection,t=this.summaryBreakdownDTItems;return this.summaryBreakdownDTItems=t.reduce((function(t,a){var r=e.find((function(e){return e.name===a.name})),n=t.find((function(e){return e.executionUniqueKey===a.executionUniqueKey}));return void 0!==r&&void 0===n?[].concat(Object(s.a)(t),[a]):t}),[]),this.summaryBreakdownDTItems}},{key:"renderScheduleProcessBreakdownSection",value:function(){var e=this,t="DataTable_SummaryBreakdown",a=this.getSummaryBreakdownDTItems(),s="Step 2: GRAX Schedule Process Breakdown";return this.props.variant===x&&(s="Executions"),m.a.createElement(h.a,{title:s,className:"slds-p-top_large",isCollapsible:!0,isOpen:!0},m.a.createElement("div",{className:"slds-grid slds-wrap"},m.a.createElement("div",{className:"slds-col slds-size_10-of-12 slds-medium-size_10-of-12 slds-large-size_10-of-12"},m.a.createElement("div",{style:{height:300}},m.a.createElement(g.a,{assistiveText:{actionsHeader:"actions",columnSort:"sort this column",columnSortedAscending:"asc",columnSortedDescending:"desc",selectAllRows:"all rows",selectRow:"select this row"},fixedHeader:!0,fixedLayout:!0,items:a,id:t,selection:this.summaryBreakdownDTSelection,selectRows:"checkbox",onRowChange:function(t,a){return e.summaryBreakdownDTHandleChanged(t,a)},onSort:function(s){e.dataTableHandleSort(t,a,s,!1)}},m.a.createElement(v.a,{label:"GRAX Schedule Process",sortable:!0,primaryColumn:!0,property:"name",isSorted:this.getIsDatatableSortedColumn(t,"name")},m.a.createElement(k,null)),m.a.createElement(v.a,{label:"Execution Unique Key",sortable:!0,property:"executionUniqueKey",isSorted:this.getIsDatatableSortedColumn(t,"executionUniqueKey")}),m.a.createElement(v.a,{label:"Start Time",sortable:!0,property:"startTimeFormatted",isSorted:this.getIsDatatableSortedColumn(t,"startTimeFormatted")}),m.a.createElement(v.a,{label:"Records",sortable:!0,property:"records",isSorted:this.getIsDatatableSortedColumn(t,"records")}),m.a.createElement(v.a,{label:"Inserted",sortable:!0,property:"inserted",isSorted:this.getIsDatatableSortedColumn(t,"inserted")}),m.a.createElement(v.a,{label:"Updated",sortable:!0,property:"updated",isSorted:this.getIsDatatableSortedColumn(t,"updated")}),m.a.createElement(v.a,{label:"Archived",sortable:!0,property:"archived",isSorted:this.getIsDatatableSortedColumn(t,"archived")}))))))}},{key:"getObjectsSelection",value:function(e){var t=this.summaryBreakdownDTSelection,a=this.itemsObjectsByDataRange;return e.reduce((function(e,r){return void 0!==t.find((function(e){return-1!==e.objectsList.indexOf(r.name)}))?[].concat(Object(s.a)(e),[a.find((function(e){return e.id===r.id}))]):e}),[])}},{key:"renderObjectsSection",value:function(){var e=this,t="DataTable_ObjectsInSummary",a=this.getItemsObjectsByDataRange(),s="Step 3: Objects";return this.props.variant===x&&(s="Objects"),m.a.createElement(h.a,{title:s,className:"slds-p-top_large",isCollapsible:!0,isOpen:!0},m.a.createElement("div",{className:"slds-grid slds-wrap"},m.a.createElement("div",{className:"slds-col slds-size_10-of-12 slds-medium-size_10-of-12 slds-large-size_10-of-12"},m.a.createElement("div",{style:{height:300}},m.a.createElement(g.a,{assistiveText:{actionsHeader:"actions",columnSort:"sort this column",columnSortedAscending:"asc",columnSortedDescending:"desc",selectAllRows:"all rows",selectRow:"select this row"},fixedHeader:!0,fixedLayout:!0,items:a,id:t,selection:this.itemsObjectsByDataRangeSelection,selectRows:"checkbox",onRowChange:function(t,a){return e.itemsObjectsByDataRangeHandleChanged(t,a)},onSort:function(s){e.dataTableHandleSort(t,a,s,!1)}},m.a.createElement(v.a,{label:"Object Name",sortable:!0,primaryColumn:!0,property:"name",isSorted:this.getIsDatatableSortedColumn(t,"name")}),m.a.createElement(v.a,{label:"Records",sortable:!0,property:"records",isSorted:this.getIsDatatableSortedColumn(t,"records")}),m.a.createElement(v.a,{label:"Inserted",sortable:!0,property:"inserted",isSorted:this.getIsDatatableSortedColumn(t,"inserted")}),m.a.createElement(v.a,{label:"Updated",sortable:!0,property:"updated",isSorted:this.getIsDatatableSortedColumn(t,"updated")}),m.a.createElement(v.a,{label:"Archived",sortable:!0,property:"archived",isSorted:this.getIsDatatableSortedColumn(t,"archived")}))))))}},{key:"renderFilterCriteriaSection",value:function(){var e=this;return this.props.variant===x?null:m.a.createElement(h.a,{title:"Filter Criteria"},m.a.createElement("div",{className:"slds-col slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1"},m.a.createElement("dl",{className:"slds-list_stacked"},m.a.createElement("dt",{className:"slds-item_label slds-text-color_weak slds-truncate",title:"From"},m.a.createElement("label",{className:"slds-form-element__label"},"From")),m.a.createElement("dd",{className:"slds-item_detail"},m.a.createElement(D.a,{onChange:function(t,a){e.setState({fromDate:a.date})},value:this.state.fromDate})),m.a.createElement("dt",{className:"slds-item_label slds-text-color_weak slds-truncate",title:"To"},m.a.createElement("label",{className:"slds-form-element__label"},"To")),m.a.createElement("dd",{className:"slds-item_detail"},m.a.createElement(D.a,{onChange:function(t,a){e.setState({toDate:a.date})},value:this.state.toDate})))),m.a.createElement("div",{className:"slds-col slds-size_1-of-1 slds-medium-size_2-of-4 slds-large-size_1-of-4 slds-m-top_small"},m.a.createElement(y.a,{className:"inline-block",defaultChecked:!this.state._currentOrgRecords,onChange:function(t){e.setState({_currentOrgRecords:!t.target.checked})},assistiveText:{label:"Show records from all environments?"},variant:"toggle",labels:{toggleDisabled:"Current Environment",toggleEnabled:"All connected SF environments"}}),m.a.createElement("div",{className:"slds-float_right"},m.a.createElement(b.a,{label:"Retrieve",variant:"brand",onClick:function(){e.loadSummaries()}}))))}},{key:"renderFilterSections",value:function(){return this.itemsObjectsByDataRange?m.a.createElement("div",null,this.summaryDataResults.length>0?this.renderAggregatedScheduleProcessSection():null,this.summaryDTSelection.length>0?this.renderScheduleProcessBreakdownSection():null,this.summaryBreakdownDTSelection.length>0?this.renderObjectsSection():null):null}},{key:"render",value:function(){return m.a.createElement("div",{style:{minHeight:2e3}},this.state.isLoading&&m.a.createElement(S.a,{size:"large",variant:"brand"}),this.renderFilterCriteriaSection(),this.renderFilterSections(),m.a.createElement(O.a,{ref:this.chart,summaryData:this.state.chartData,renderCounter:this.state.renderCounter}))}}]),a}(m.a.Component);R.defaultProps={variant:"normal",filterParams:{fromDate:new Date,toDate:new Date,gspId:null}}}}]);
//# sourceMappingURL=2.38316cc5.chunk.js.map