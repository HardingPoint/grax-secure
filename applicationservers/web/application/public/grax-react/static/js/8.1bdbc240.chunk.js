(this.webpackJsonpgraxreact=this.webpackJsonpgraxreact||[]).push([[8,14],{256:function(e,t,a){"use strict";a.r(t);var i=a(19),n=a(35),s=a(37),l=a(29),o=a(36),r=a(0),c=a.n(r),d=a(30),u=a.n(d),p=a(282),h=a(287),m=a(286),g=a(5),f=a(66),b=a(273),v=a(127),y=a(17),C=a(275),O=a(76),_=a(283),S=a(280),F=a(22),x=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(l.a)(t).call(this,e))).state={sortColumn:"Id",sortDirection:"asc",chunks:[],items:[],extraInfo:{},page:0,selection:[],isLoaded:!1,isLoading:!1,deleteConfirmIsOpen:!1,deleteConfirmIsChecked:!1,deleteConfirmCallback:function(){},deleteConfirmTotal:0},a}return Object(o.a)(t,e),Object(n.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.renderKey!==e.renderKey||this.state.items!==t.items||this.state.selection!==t.selection||this.state.isLoaded!==t.isLoaded||this.state.isLoading!==t.isLoading||this.state.sortColumn!==t.sortColumn||this.state.sortDirection!==t.sortDirection||this.state.deleteConfirmIsOpen!==t.deleteConfirmIsOpen||this.state.deleteConfirmIsChecked!==t.deleteConfirmIsChecked}},{key:"getDataHandler",value:function(e,t,a){var i=this,n=t+" "+a;this.setState({isLoading:!0,page:e,sortColumn:t,sortDirection:a}),S.a.ajax({type:"GET",url:S.c+"/grax-app/grax-data-lake"+Object(S.b)({action:"load",dataIndex:this.props.dataIndex,_select:u.a.union(this.props.columns,this.props.hiddenColumns,["Id","graxorgid","attributes.type"]).join(",")||"Id",_q:this.props.filterQuery,_limit:100,_from:100*e,_sort:n,_includeMetadata:!0}),success:function(e){var t=e.results;i.props.filterFunction&&(t=i.props.filterFunction(t)),t=u.a.map(t,(function(e,t){return u.a.forEach(e,(function(t,a){if("string"==typeof t&&F.c.test(t)){var i=Object(F.j)(t);i.isValid()&&(e[a]=i.tz(F.d).format(-1!==i._i.indexOf(":")?F.a:F.b))}"boolean"==typeof t&&(e[a]=t?"true":"false")})),Object(g.a)({},e,{},{id:t.toString()})})),i.setState({page:0,data:t,extraInfo:e.extraInfo||{total:0,size:100,totalRetrieved:0},items:t,isLoaded:!0,isLoading:!1})},error:function(e,t,a){console.error(e,t,a),i.setState({isLoaded:!0,isLoading:!1,items:[],error:a.toString()})}})}},{key:"componentDidMount",value:function(){this.getDataHandler(0,this.state.sortColumn,this.state.sortDirection)}},{key:"handleChanged",value:function(e,t){this.setState({selection:t.selection.slice(0,10)}),console.log(e,t)}},{key:"handleSort",value:function(e){e.property&&this.getDataHandler(this.state.page,e.property,e.sortDirection)}},{key:"render",value:function(){var e=this;return this.state.isLoaded?c.a.createElement("div",null,c.a.createElement("div",{style:{position:"relative"}},this.state.isLoading&&c.a.createElement(f.a,{size:"large",variant:"brand"}),c.a.createElement(b.a,{assistiveText:{actionsHeader:"actions",columnSort:"sort this column",columnSortedAscending:"asc",columnSortedDescending:"desc",selectAllRows:"all rows",selectRow:"select this row"},fixedLayout:!0,items:this.state.items,id:"GRAXDeleteDataTable",onRowChange:this.handleChanged.bind(this),onSort:this.handleSort.bind(this),selection:this.state.selection,selectRows:!0},this.props.columns.map((function(t){return c.a.createElement(v.a,{key:"col"+t,id:t,isSorted:e.state.sortColumn===t,label:t,property:t,sortable:null==e.props.sortableColumns||-1!==e.props.sortableColumns.indexOf(t),sortDirection:e.state.sortDirection})})))),c.a.createElement("div",{className:"-x-small-buttons--horizontal slds-p-top_small"},c.a.createElement(_.a,{totalItems:this.state.items.length>0?this.state.extraInfo.total:0,pageSize:100,onChangePage:function(t,a){a||e.getDataHandler(t-1,e.state.sortColumn,e.state.sortDirection)}})),c.a.createElement("div",{className:"-x-small-buttons--horizontal slds-p-top_medium"},c.a.createElement(y.a,{label:"Delete Selection",disabled:this.state.selection.length<1||this.state.isLoading,onClick:function(){e.setState({deleteConfirmIsOpen:!0,deleteConfirmIsChecked:!1,deleteConfirmTotal:e.state.selection.length,deleteConfirmCallback:function(){e.state.deleteConfirmIsChecked&&confirm("Are you sure that you want to delete the selected records?")&&(S.a.ajax({type:"POST",url:S.c+"/grax-app/grax-data-lake/deleteAPI"+Object(S.b)({action:"delete"}),contentType:"application/json; charset=utf-8",data:JSON.stringify(u.a.map(e.state.selection,(function(e){return u.a.pick(e,["Id","graxorgid","_id","_type","_index","attributes.type"])}))),success:function(e){alert(e.state)}}),e.setState({selection:[],deleteConfirmIsOpen:!1,deleteConfirmCallback:function(){},deleteConfirmTotal:0}))}})}})),c.a.createElement(C.a,{dismissible:!0,footer:[c.a.createElement("div",{key:"agree",className:"slds-p-bottom_small"},c.a.createElement(O.a,{assistiveText:{label:"I understand the risks"},id:"delete-confirm",labels:{label:"I understand the risks"},onChange:function(t){e.setState({deleteConfirmIsChecked:t.target.checked})}})),c.a.createElement(y.a,{key:"cancelBtn",label:"Cancel",onClick:function(){e.setState({deleteConfirmIsOpen:!1,deleteConfirmIsChecked:!1})}}),c.a.createElement(y.a,{key:"deleteBtn",label:"Delete",onClick:this.state.deleteConfirmCallback,variant:"destructive",disabled:!this.state.deleteConfirmIsChecked})],isOpen:this.state.deleteConfirmIsOpen,onRequestClose:function(){e.setState({deleteConfirmIsOpen:!1,deleteConfirmIsChecked:!1})},prompt:"error",size:"medium",align:"top",dismissOnClickOutside:!1,title:c.a.createElement("span",null,"Delete ",c.a.createElement("b",null,this.state.deleteConfirmTotal)," record(s)")},c.a.createElement("div",{className:"slds-m-around_medium"},"Please confirm that you want to delete these record(s) from your GRAX Datalake.",c.a.createElement("br",null),"After you confirm deletion, these records are NOT recoverable."))):c.a.createElement("div",{style:{position:"relative",height:"2rem"}},c.a.createElement(f.a,{size:"medium",variant:"brand"}))}}]),t}(c.a.Component),E=a(284);a.d(t,"default",(function(){return k}));var N=["text","date","number"],k=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(l.a)(t).call(this,e))).state={selectedDataIndex:null,retrieved:!1,retrievedCounter:0,_graxFields:null,_graxFieldsSelection:null,_graxFieldsSelectionList:null,_filterFunction:function(e){return e},_getFilterQuery:function(){return null},_filterValuesFields:[],_graxSortableFields:null},a}return Object(o.a)(t,e),Object(n.a)(t,[{key:"hasFieldSelected",value:function(){return null!=this.state._graxFields&&null!=this.state._graxFieldsSelectionList&&this.state._graxFieldsSelectionList.length>0}},{key:"render",value:function(){var e=this;return c.a.createElement("div",null,c.a.createElement(p.a,{isCollapsible:!0,isOpen:!0,title:"Select the GRAX Table"},c.a.createElement(h.a,{onSelect:function(t,a){e.setState({selectedDataIndex:a[0]})},excludeIds:["graxgrax_loggingindex"],onRequestRemoveSelectedOption:function(t,a){e.setState({retrieved:!1,selectedDataIndex:null,_graxFieldsSelection:null,_graxFieldsSelectionList:null})}}),c.a.createElement("div",{className:"slds-m-bottom_large"})),c.a.createElement(p.a,{isCollapsible:!0,isOpen:!0,title:"Search GRAX Table"},null!=this.state.selectedDataIndex?c.a.createElement(m.default,{dataIndex:this.state.selectedDataIndex.id,onLoad:function(t,a,i,n){console.log("onLoad",a,n,i),e.setState({_graxFields:i,_graxFieldsSelection:a,_graxFieldsSelectionList:n,_graxSortableFields:u.a.reduce(i,(function(e,t,a){return-1!==N.indexOf(t.type)&&e.push(t.id),e}),[])})},onChange:function(t,a,i,n){console.log("onChange",a,n);var s=e.state.retrievedCounter;n.length>e.state._graxFieldsSelectionList.length&&s++,e.setState({retrievedCounter:s,_graxFieldsSelection:a,_graxFieldsSelectionList:n})}}):"No GRAX Table selected...",c.a.createElement("div",{className:"slds-m-bottom_large"})),c.a.createElement(p.a,{isCollapsible:!0,isOpen:!0,title:"Filter Records"},null!=this.state._graxFieldsSelectionList&&c.a.createElement(E.a,{SObjectType:this.state.selectedDataIndex.label,filterableFieldOptions:this.state._graxFields,onFilterValueChangeHandler:function(t,a,i){e.setState({retrievedCounter:e.state.retrievedCounter,_filterFunction:t,_getFilterQuery:i,_graxFieldsSelectionList:e.state._graxFieldsSelectionList,_filterValuesFields:a})}}),c.a.createElement("div",{className:"slds-m-bottom_large"})),c.a.createElement(p.a,{isCollapsible:!0,isOpen:!0,title:"GRAX Stored Records"},c.a.createElement("div",{className:"-x-small-buttons--horizontal slds-p-bottom_large"},c.a.createElement(y.a,{label:"Retrieve",variant:"brand",onClick:function(){e.setState({retrieved:null!=e.state.selectedDataIndex,retrievedCounter:e.state.retrievedCounter+1})},disabled:!this.hasFieldSelected()})),this.state.retrieved&&this.state._graxFieldsSelectionList&&c.a.createElement(x,{key:"GRAXDeleteDataTable_"+this.state.retrievedCounter,renderKey:"GRAXDeleteDataTable_"+this.state.retrievedCounter,columns:this.state._graxFieldsSelectionList,hiddenColumns:this.state._filterValuesFields,dataIndex:this.state.selectedDataIndex.id,filterFunction:this.state._filterFunction,filterQuery:this.state._getFilterQuery(),sortableColumns:this.state._graxSortableFields})))}}]),t}(c.a.Component)},280:function(e,t,a){"use strict";(function(e){a.d(t,"c",(function(){return s})),a.d(t,"f",(function(){return l})),a.d(t,"d",(function(){return r})),a.d(t,"e",(function(){return c})),a.d(t,"b",(function(){return d}));var i=a(281),n=a.n(i);a.d(t,"a",(function(){return n.a}));var s="";e&&Object({NODE_ENV:"production",PUBLIC_URL:"/grax-app/assets",REACT_APP_BASIC_TOKEN:"c1ZiWTdHc3E2eTJxc3h5THRmTFVUdWM3cFBsMnRteTJQUWR5RWJiZjphNjcyM2JmY2ViNDZhODUwZjBlYmNkNGMzMzgzYWNjMzVjYWIxNWU1MDM2NTI3MWFjNDUzYTkxZjM2ZjA1NGEy",REACT_APP_ORGID:"00D6g000006wAo3EAE",REACT_APP_BASE_URL:""})&&!window.__grax__&&(window.__grax__={orgid:"00D6g000006wAo3EAE",pageParams:{authorization:"c1ZiWTdHc3E2eTJxc3h5THRmTFVUdWM3cFBsMnRteTJQUWR5RWJiZjphNjcyM2JmY2ViNDZhODUwZjBlYmNkNGMzMzgzYWNjMzVjYWIxNWU1MDM2NTI3MWFjNDUzYTkxZjM2ZjA1NGEy"}});var l=window.__grax__.token,o=window.__grax__._csrf,r=window.__grax__.orgid,c=(window.__grax__.userid,window.__grax__.pageParams||{});function d(e){return null!==e&&void 0!==e||(e={}),null!==e.action&&void 0!==e.action&&""!==e.action||(e.action="load"),"?"+n.a.param(e)}n.a.ajaxSetup({beforeSend:function(e,t){var a;e.setRequestHeader("sfdcorgid",r),null!=c.authorization?e.setRequestHeader("Authorization","Basic "+c.authorization):e.setRequestHeader("Authorization","Bearer "+l),a=t.type,/^(GET|HEAD|OPTIONS|TRACE)$/.test(a)||this.crossDomain||e.setRequestHeader("X-CSRFToken",o),e.withCredentials=!0,!0!==t.skipFail&&e.fail((function(e,t,a){console.error(e),404!==e.status&&"Not Found"!==a&&window.showError(e.statusText+": "+e.responseText)}))}})}).call(this,a(90))},282:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var i=a(19),n=a(35),s=a(37),l=a(29),o=a(89),r=a(36),c=a(0),d=a.n(c),u=a(9),p=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(l.a)(t).call(this,e))).state={isOpen:!0===e.isOpen||void 0===e.isCollapsible},a.handleToggle=a.handleToggle.bind(Object(o.a)(a)),a}return Object(r.a)(t,e),Object(n.a)(t,[{key:"handleToggle",value:function(e){var t=!this.state.isOpen;this.setState({isOpen:t}),this.props.onToggle&&this.props.onToggle(t),e.preventDefault()}},{key:"render",value:function(){var e=d.a.createElement("span",{className:"slds-truncate"+(this.props.isCollapsible?"":" slds-p-horizontal_small"),title:this.props.title},this.props.title);return d.a.createElement("div",{id:this.props.id||this.props.key,className:["slds-section",this.state.isOpen&&"slds-is-open",this.props.className].join(" ")},d.a.createElement("h3",{className:"slds-section__title slds-theme_shade"},this.props.isCollapsible?d.a.createElement("button",{className:"slds-button slds-section__title-action",onClick:this.handleToggle},d.a.createElement(u.a,{assistiveText:{label:this.props.title},category:"utility",name:"switch",size:"x-small",className:"slds-section__title-action-icon slds-button__icon slds-button__icon_left"}),e):e),this.state.isOpen&&d.a.createElement("div",{className:"slds-section__content"},this.props.children))}}]),t}(d.a.Component)},283:function(e,t,a){"use strict";var i=a(88),n=a(19),s=a(35),l=a(37),o=a(29),r=a(36),c=a(0),d=a.n(c),u=a(267),p=a(17),h=a(59),m=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(l.a)(this,Object(o.a)(t).call(this,e))).state={pager:{}},a}return Object(r.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.props.totalItems&&this.setPage(this.props.currentPage,!0)}},{key:"setPage",value:function(e,t){var a=this.props,i=a.totalItems,n=a.pageSize,s=this.state.pager;e<1||e>s.totalPages||(s=this.getPager(i,e,n),this.setState({pager:s}),this.props.onChangePage(e,t))}},{key:"getPager",value:function(e,t,a){t=t||1,a=a||10;var n=!1;e>1e4&&(e=1e4,n=!0);var s,l,o=Math.ceil(e/a);o<=10?(s=1,l=o):t<=6?(s=1,l=10):n&&t+3>=o?(s=o-8,l=o):t+4>=o?(s=o-9,l=o):(s=t-5,l=t+4);var r=(t-1)*a,c=Math.min(r+a-1,e-1),d=Object(i.a)(Array(l+1-s).keys()).map((function(e){return s+e}));return{totalItems:e,currentPage:t,pageSize:a,totalPages:o,startPage:s,endPage:l,startIndex:r,endIndex:c,pages:d,isNarrow:n}}},{key:"render",value:function(){var e=this,t=this.state.pager;return!t.pages||t.pages.length<=1?null:d.a.createElement(u.a,null,d.a.createElement(p.a,{iconCategory:"utility",iconName:"left",iconPosition:"left",label:"First",variant:"neutral",onClick:function(){return e.setPage(1)},disabled:1===t.currentPage}),d.a.createElement(p.a,{iconCategory:"utility",iconName:"chevronleft",iconPosition:"left",variant:"neutral",onClick:function(){return e.setPage(t.currentPage-1)},disabled:1===t.currentPage}),t.pages.map((function(a,i){return d.a.createElement(p.a,{key:"SLDSPaginator"+Date.now()+i,label:a,variant:t.currentPage===a?"brand":"neutral",onClick:function(){return e.setPage(a)}})})),t.isNarrow&&t.currentPage>=t.totalPages-3&&d.a.createElement(h.a,{align:"top right",content:"The list is too long, try adding more filters to optimize the results."},d.a.createElement(p.a,{label:"\xb7\xb7\xb7",variant:"neutral"})),d.a.createElement(p.a,{iconCategory:"utility",iconName:"chevronright",iconPosition:"right",variant:"neutral",onClick:function(){return e.setPage(t.currentPage+1)},disabled:t.currentPage===t.totalPages}),d.a.createElement(p.a,{iconCategory:"utility",iconName:"right",iconPosition:"right",label:"Last",variant:"neutral",onClick:function(){return e.setPage(t.totalPages)},disabled:t.currentPage===t.totalPages}))}}]),t}(d.a.Component);m.defaultProps={currentPage:1,pageSize:10},t.a=m},284:function(e,t,a){"use strict";var i=a(88),n=a(19),s=a(35),l=a(37),o=a(29),r=a(36),c=a(0),d=a.n(c),u=a(30),p=a.n(u),h=a(25),m=a.n(h),g=a(270),f=a(269),b=a(66),v=a(76),y=a(254),C=a(297),O=a(17),_=a(280),S=a(22),F=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(l.a)(this,Object(o.a)(t).call(this,e))).state={options:[],inputValue:"",selection:[],isLoaded:!1,error:null},a}return Object(r.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){_.a.ajax({type:"GET",url:_.c+"/grax-app/grax-data-lake/salesforce/sobjects/"+this.props.SObjectName+"/fields/"+this.props.fieldName+Object(_.b)({action:"load"}),data:{_select:"name,type,picklistValues"},success:function(e){this.setState({options:p.a.map(e.picklistValues||[],(function(e,t){return{id:e.value,label:e.label}})),isLoaded:!0}),this.props.onLoad&&this.props.onLoad(!0)}.bind(this),error:function(e,t,a){console.error(e,t,a),this.setState({isLoaded:!0,error:a.toString()}),this.props.onLoad&&this.props.onLoad(!1,a)}.bind(this)})}},{key:"render",value:function(){var e=this;return this.state.error?d.a.createElement("div",null,"Error: ",this.state.error):this.state.isLoaded?null==this.state.options||0===this.state.options.length?(this.props.onElseComponent&&this.props.onRender(!1),this.props.elseComponent):(this.props.onLoad&&this.props.onRender(!0),d.a.createElement(d.a.Fragment,null,d.a.createElement(f.a,{classNameMenu:"scrollable-GRAXSFieldCombobox",events:{onChange:function(t,a){var i=a.value;e.setState({inputValue:i}),e.props.onChange&&e.props.onChange(t,i)},onRequestRemoveSelectedOption:function(t,a){e.setState({inputValue:"",selection:a.selection}),e.props.onRequestRemoveSelectedOption&&e.props.onRequestRemoveSelectedOption(t,a.selection)},onSelect:function(t,a){e.setState({inputValue:"",selection:a.selection}),e.props.onSelect&&e.props.onSelect(t,a.selection)},onRequestClose:function(t,a){e.props.onSelect&&e.state.inputValue&&e.props.onSelect(t,[{id:e.state.inputValue,label:e.state.inputValue}])}},labels:{placeholder:"Select Option"},options:Object(S.e)({inputValue:this.state.inputValue,limit:1e3,options:this.state.options,selection:this.state.selection}),selection:this.state.selection,value:this.state.inputValue,variant:this.props.variant||"inline-listbox",multiple:this.props.multiple||!1,required:!0}))):d.a.createElement("div",{style:{position:"relative",height:"2rem"}},d.a.createElement(b.a,{size:"small",variant:"base"}))}}]),t}(d.a.Component);a.d(t,"a",(function(){return k}));var x=function(e){return e.replace(/[\*\+\-=~><\"\?^\${}\(\)\:\!\/[\]\\\s]/g,"\\$&").replace(/\|\|/g,"\\||").replace(/\&\&/g,"\\&&").replace(/AND/g,"\\A\\N\\D").replace(/OR/g,"\\O\\R").replace(/NOT/g,"\\N\\O\\T")},E={text:[{id:"eq",label:"==",isNegated:!1},{id:"eq",label:"!=",isNegated:!0},{id:"contains",label:"contains",isNegated:!1},{id:"contains",label:"not contains",isNegated:!0},{id:"in",label:"in",isNegated:!1},{id:"in",label:"not in",isNegated:!0},{id:"exists",label:"exists",isNegated:!1,type:"boolean"}],date:[{id:"eq",label:"==",isNegated:!1},{id:"eq",label:"!=",isNegated:!0},{id:"gt",label:">",isNegated:!1},{id:"lt",label:"<",isNegated:!1},{id:"gte",label:">=",isNegated:!1},{id:"lte",label:"<=",isNegated:!1},{id:"exists",label:"exists",isNegated:!1,type:"boolean"}],number:[{id:"eq",label:"==",isNegated:!1},{id:"eq",label:"!=",isNegated:!0},{id:"gt",label:">",isNegated:!1},{id:"lt",label:"<",isNegated:!1},{id:"gte",label:">=",isNegated:!1},{id:"lte",label:"<=",isNegated:!1},{id:"exists",label:"exists",isNegated:!1,type:"boolean"}],long:[{id:"eq",label:"==",isNegated:!1},{id:"eq",label:"!=",isNegated:!0},{id:"gt",label:">",isNegated:!1},{id:"lt",label:"<",isNegated:!1},{id:"gte",label:">=",isNegated:!1},{id:"lte",label:"<=",isNegated:!1},{id:"exists",label:"exists",isNegated:!1,type:"boolean"}],boolean:[{id:"eq",label:"==",isNegated:!1},{id:"exists",label:"exists",isNegated:!1}]},N=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(l.a)(this,Object(o.a)(t).call(this,e)))._isMounted=!1,a.state={inputValue:"",selection:[],isOpened:!1},a}return Object(r.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this.props.selection&&(console.log(this.props.selection),this.setState({selection:this.props.selection}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"filterOptionsHandler",value:function(){var e=this.props.options||[];return this.props.filterOptionsHandler&&this.state.isOpened&&(e=this.props.filterOptionsHandler(e)),Object(g.a)({inputValue:this.state.inputValue,limit:1e3,options:e,selection:this.state.selection})}},{key:"render",value:function(){var e=this;return d.a.createElement(d.a.Fragment,null,d.a.createElement(f.a,{classNameMenu:"scrollable-GRAXFilterableCombobox",events:{onChange:function(t,a){var i=a.value;e.setState({inputValue:i}),e.props.onChange&&e.props.onChange(t,i)},onRequestRemoveSelectedOption:function(t,a){e._isMounted&&e.setState({inputValue:"",selection:a.selection}),e.props.onRequestRemoveSelectedOption&&e.props.onRequestRemoveSelectedOption(t,a.selection)},onSelect:function(t,a){e._isMounted&&e.setState({inputValue:"",selection:a.selection}),e.props.onSelect&&e.props.onSelect(t,a.selection)},onOpen:function(t,a){e._isMounted&&e.setState({isOpened:!0})},onClose:function(t,a){e._isMounted&&e.setState({isOpened:!1})}},labels:{placeholder:this.props.placeholder},options:this.filterOptionsHandler(),selection:this.state.selection,value:this.state.inputValue,variant:this.props.variant||"inline-listbox",required:!0,multiple:!1}))}}]),t}(d.a.Component),k=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(l.a)(this,Object(o.a)(t).call(this,e))).state={_filterValues:null,_error:null,_filterValuesFields:[]},a}return Object(r.a)(t,e),Object(s.a)(t,[{key:"isLoaded",value:function(){return this.state._error||null!=this.props.filterableFieldOptions}},{key:"getFilterValueStruct",value:function(){return{id:null,value:null,operator:"eq",isNegated:!1,isActive:!0,selectedField:null}}},{key:"getFilterValuesList",value:function(e){var t=this;return p.a.map(e,(function(e,a){var i=t.getFilterValueStruct();return i.id=a,i.value=e.value,i.operator=e.operator,i.isNegated=e.isNegated,i.isActive=e.isActive,i.selectedField=p.a.filter(t.props.filterableFieldOptions,(function(e,t){return e&&e.id===a}))[0]||null,i}))}},{key:"componentDidMount",value:function(){var e=this.props.filterValues||{},t=Object.keys(e);this.setState({_filterValues:e,_filterValuesFields:t,_filterValuesList:this.getFilterValuesList(e)}),this.props.onFilterValueChangeHandler(this.getFilterFunction.bind(this),t,this.getFilterQuery.bind(this),this.state._filterValues)}},{key:"onFilterValueChangeHandler",value:function(e,t){var a=this.state._filterValues;if(t&&t.length>0){var i=t[0]||null;e.id=i.id,e.selectedField=i,a[e.id]={value:e.value,isActive:e.isActive,operator:e.operator,isNegated:e.isNegated,selectedField:i}}else delete a[e.id],e.id=null,e.selectedField=null;var n=Object.keys(a);this.setState({_filterValues:a,_filterValuesFields:n,_filterValuesList:this.state._filterValuesList}),this.props.onFilterValueChangeHandler&&this.props.onFilterValueChangeHandler(this.getFilterFunction.bind(this),n,this.getFilterQuery.bind(this),this.state._filterValues)}},{key:"addAnotherFieldHandler",value:function(){var e=this.state._filterValuesList;0!==e.length&&null==e[e.length-1].id||(e.push(this.getFilterValueStruct()),this.setState({_filterValuesList:e}))}},{key:"removeFieldHandler",value:function(e){var t=this.state._filterValues,a=this.state._filterValuesList;delete t[a[e].id],a.splice(e,1),this.setState({_filterValues:t,_filterValuesFields:Object.keys(t),_filterValuesList:a})}},{key:"getFilterFunction",value:function(e){var t=this;return p.a.filter(e,(function(e,a){var n=!0;return p.a.forEach(t.state._filterValues,(function(t,a){if(t.isActive){var s=t.operator,l=t.value;"in"!==s&&Array.isArray(l)?l=l.length>0?l[0]:null:"in"!==s||Array.isArray(l)||(l=l.split(" OR "));var o=t.isNegated,r=!1,c=e[a];"eq"!==s||""===l||Boolean(l)||(s="exists",o=!1),Array.isArray(l)&&"in"!==s&&(l=l.length>0?l[0]:null),"date"===t.selectedField.type&&((c=m()(c))&&(c=c.format("YYYY-MM-DD")),(l=m()(l))&&(l=l.format("YYYY-MM-DD"))),"boolean"!==t.selectedField.type||Boolean(l)||(l=!0,o=!0),r="exists"===s?Boolean(c)===Boolean(l):"contains"===s?String(c).toLowerCase().includes(l.toLowerCase()):"in"===s?l&&l.length>0&&p.a.includes.apply(p.a,[l].concat(Object(i.a)("string"===typeof c?[c]:c))):p.a[s](c,l),n&=o?!r:r}})),n}))||[]}},{key:"getFilterQuery",value:function(){var e={gt:">",gte:">=",lt:"<",lte:"<="},t=[];return p.a.forEach(this.state._filterValues,(function(a,i){var n=a.operator;if(a.isActive&&!n.startsWith("_")){var s=a.value;"in"!==n&&Array.isArray(s)?s=s.length>0?x(s[0]):null:"in"!==n||Array.isArray(s)||(s=p.a.map(s.split(" OR "),(function(e){return x(e)})));var l=a.isNegated;"eq"===n&&l&&!Boolean(s)&&(n="exists",s=l),"exists"===n&&(l=!Boolean(s));var o="(";if(l&&(o+="NOT "),o+="(","boolean"!==a.selectedField.type||Boolean(s)||(o+="NOT "),"in"===n){var r=[];p.a.each(s,(function(e,t){r.push('"'+e+'"')})),o+="doc."+i+":("+r.join(" OR ")+")"}else if("exists"===n)o+="_exists_:doc."+i;else if(o+="doc."+i+":","eq"===n)"boolean"===a.selectedField.type?o+="true":"number"===a.selectedField.type?o+=s?parseFloat(s):"":"date"===a.selectedField.type?o+=s?m()(s).format("YYYY-MM-DD"):"":o+='"'+s+'"';else if("contains"===n){var c=s?String(s):"";o+="(",o+='"'+x(s)+'"',o+=" OR ",o+=x(c.toLowerCase()),o+=" OR ",o+="*"+x(c.toLowerCase())+"*",o+=")"}else"date"===a.selectedField.type?o+=e[n]+(s?m()(s).format("YYYY-MM-DD"):""):o+=e[n]+(s?x(s):"");o+="))",t.push(o)}})),t.length>0?t.join(" AND "):null}},{key:"getSelectionValues",value:function(e){return e?p.a.reduce(e,(function(e,t){return e.push(t.id),e}),[]):null}},{key:"render",value:function(){var e=this;return this.state._error?d.a.createElement("div",null,"Error: ",this.state._error):this.isLoaded()?d.a.createElement(d.a.Fragment,null,d.a.createElement("table",{className:"slds-table slds-table_cell-buffer slds-table_bordered slds-no-row-hover"},d.a.createElement("thead",null,d.a.createElement("tr",{className:"slds-line-height_reset"},d.a.createElement("th",{className:"slds-text-title_caps",scope:"col"},d.a.createElement("div",{className:"slds-truncate",title:"Field"},"Field")),d.a.createElement("th",{className:"slds-text-title_caps",scope:"col"},d.a.createElement("div",{className:"slds-truncate",title:"Operator"},"Operator")),d.a.createElement("th",{className:"slds-text-title_caps",scope:"col"},d.a.createElement("div",{className:"slds-truncate",title:"Filter Value"},"Filter Value")),d.a.createElement("th",{className:"slds-text-title_caps",scope:"col"},d.a.createElement("div",{className:"slds-truncate",title:"Is Active?"},"Is Active?")),d.a.createElement("th",{className:"slds-text-title_caps",scope:"col"},d.a.createElement("div",{className:"slds-truncate"})))),d.a.createElement("tbody",null,p.a.map(this.state._filterValuesList,function(e,t){var a=this,i=e.id,n=e.selectedField||{};return d.a.createElement("tr",{className:"slds-hint-parent",key:"fieldName: "+(i||"")},d.a.createElement("td",{"data-label":"Field",style:{width:"30vw"}},i||d.a.createElement(N,{placeholder:"Select Field to filter",options:this.props.filterableFieldOptions||[],filterOptionsHandler:function(e){return p.a.filter(e,(function(e,t){return e&&-1===a.state._filterValuesFields.indexOf(e.id)}))||[]},selection:p.a.find(this.props.filterableFieldOptions,(function(e){return e&&e.id===i}))||[],onSelect:function(t,i){return a.onFilterValueChangeHandler(e,i)},onRequestRemoveSelectedOption:function(t,i){return a.onFilterValueChangeHandler(e,i)}})),d.a.createElement("td",{"data-label":"Operator",style:{width:"20vw"}},n&&("boolean"===n.type&&E[n.type].label||d.a.createElement(N,{placeholder:"Select Operator to Compare",options:E[n.type]||[],selection:[],variant:"readonly",onSelect:function(t,i){i[0].type=i[0].type||e.selectedField.type,e.operator=i[0].id,e.isNegated=i[0].isNegated,e.type!==i[0].type&&(e.value=null,"boolean"===i[0].type&&(e.value=!1),"text"===i[0].type&&(e.value=""),e.type=i[0].type),a.onFilterValueChangeHandler(e,[e.selectedField])}}))),d.a.createElement("td",{"data-label":"Filter Value",style:{width:"30vw"}},n&&(("boolean"===n.type||"exists"===e.operator)&&d.a.createElement(v.a,{defaultChecked:e.value,onChange:function(t){e.value=t.target.checked,a.onFilterValueChangeHandler(e,[e.selectedField])}})||("text"===n.type||"number"===n.type||"long"===n.type)&&d.a.createElement(F,{SObjectName:this.props.SObjectType,fieldName:n.id,onSelect:function(t,i){e.value=a.getSelectionValues(i),a.onFilterValueChangeHandler(e,[e.selectedField])},onRequestRemoveSelectedOption:function(t,i){e.value=a.getSelectionValues(i),a.onFilterValueChangeHandler(e,[e.selectedField])},elseComponent:d.a.createElement(y.a,{defaultValue:e.value,assistiveText:{label:n.label},id:n.id,onBlur:function(t){e.value=t.target.value,a.onFilterValueChangeHandler(e,[e.selectedField])}}),onRender:function(e){},multiple:"in"===e.operator,variant:"in"===e.operator?"base":"inline-listbox"})||"date"===n.type&&d.a.createElement(C.a,{value:e.value,onChange:function(t,i){e.value=i.date,a.onFilterValueChangeHandler(e,[e.selectedField])},className:"inline-table",menuPosition:"relative",hasStaticAlignment:!0}))),d.a.createElement("td",{"data-label":"Is Active?",style:{width:"10vw"}},d.a.createElement(v.a,{defaultChecked:e.isActive,onChange:function(t){e.isActive=t.target.checked,a.onFilterValueChangeHandler(e,[e.selectedField])}})),d.a.createElement("td",{"data-label":"Actions",style:{width:"10vw"}},d.a.createElement(O.a,{label:"Remove Filter",variant:"base",onClick:function(){a.removeFieldHandler(t)}})))}.bind(this)))),d.a.createElement("div",{className:"slds-p-top_medium"},d.a.createElement(O.a,{label:"Add Filter",variant:"brand",onClick:function(){e.addAnotherFieldHandler()},disabled:null==this.props.filterableFieldOptions||0===this.props.filterableFieldOptions.length||this.props.filterableFieldOptions.length===this.state._filterValuesFields.length}))):d.a.createElement("div",{style:{position:"relative",height:"5rem"}},d.a.createElement(b.a,{size:"small",variant:"base"}))}}]),t}(d.a.Component)},286:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return y}));var i,n=a(19),s=a(35),l=a(37),o=a(29),r=a(89),c=a(36),d=a(0),u=a.n(d),p=a(30),h=a.n(p),m=a(66),g=a(269),f=a(280),b=a(22),v="Fields",y=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(l.a)(this,Object(o.a)(t).call(this,e))).state={options:[],inputValue:"",selection:[{id:"Id",label:"Id",type:"text"}],isLoaded:!1,error:null},a.getMappedFieldList=a.getMappedFieldList.bind(Object(r.a)(a)),a}return Object(c.a)(t,e),Object(s.a)(t,[{key:"getMappedFieldList",value:function(e){return h.a.map(e||this.state.selection,(function(e){return e.id}))}},{key:"onLoadHandler",value:function(e,t){var a=this.getMappedFieldList(t);this.props.onLoad&&this.props.onLoad(e,t,this.state.options,a)}},{key:"onChangeHandler",value:function(e,t){var a=this.getMappedFieldList(t);this.props.onChange&&this.props.onChange(e,t,this.state.options,a),Object(b.l)(i+v,JSON.stringify(a))}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,i=this.props.dataIndex,this.props.cookieSubfix&&(v+=this.props.cookieSubfix),f.a.ajax({type:"GET",url:f.c+"/grax-app/grax-data-lake/getDataTypeFields/"+i+Object(f.b)({action:"load"}),data:{},success:function(t){if(e._isMounted){var a=h.a.map(t,(function(e,t){return{id:t,label:t,type:e}}));e.setState({options:a,isLoaded:!0});var n=Object(b.f)(i+v);n.startsWith("[")||(n="[]");var s=JSON.parse(n);e.setState({selection:s.length>0?h.a.sortBy(h.a.reduce(a,(function(e,t){return-1!==s.indexOf(t.id)&&e.push(t),e}),[]),(function(e){return s.indexOf(e.id)})):e.state.selection})}e.onLoadHandler(null,e.state.selection)},error:function(t,a,i){console.error(t,a,i),e._isMounted&&e.setState({isLoaded:!0,error:i.toString()})}})}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this;return this.state.error?u.a.createElement("div",null,"Error: ",this.state.error):this.state.isLoaded?u.a.createElement(u.a.Fragment,null,u.a.createElement(g.a,{classNameMenu:"scrollable-GRAXFieldsCombobox",events:{onChange:function(t,a){var i=a.value;e.setState({inputValue:i})},onRequestRemoveSelectedOption:function(t,a){e.setState({inputValue:"",selection:a.selection}),e.onChangeHandler(t,a.selection)},onSelect:function(t,a){e.setState({inputValue:"",selection:a.selection}),e.onChangeHandler(t,a.selection)},onRequestClose:function(t,a){if(e.props.onSelect&&e.state.inputValue){var i=e.getMappedFieldList(a.selection);e.props.onSelect(t,[{id:e.state.inputValue,label:e.state.inputValue}],e.state.options,i)}}},labels:{placeholder:"Select Option"},options:Object(b.e)({inputValue:this.state.inputValue,limit:1e3,options:this.state.options,selection:this.state.selection}),selection:this.state.selection,value:this.state.inputValue,required:!0,multiple:!0})):u.a.createElement("div",{style:{position:"relative",height:"2rem"}},u.a.createElement(m.a,{size:"small",variant:"base"}))}}]),t}(u.a.Component)},287:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var i=a(19),n=a(35),s=a(37),l=a(29),o=a(36),r=a(0),c=a.n(r),d=a(66),u=a(269),p=a(280),h=a(30),m=a.n(h),g=a(22),f=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(l.a)(t).call(this,e))).state={options:[],inputValue:"",selection:[],isLoaded:!1,error:null},a}return Object(o.a)(t,e),Object(n.a)(t,[{key:"componentDidMount",value:function(){p.a.ajax({type:"GET",url:p.c+"/grax-app/grax-data-lake/getDataTypes"+Object(p.b)({action:"load"}),data:{},success:function(e){var t=this;this.props.excludeIds&&(e=m.a.filter(e,(function(e){return-1===t.props.excludeIds.indexOf(e.id)}))),this.setState({options:e,isLoaded:!0})}.bind(this),error:function(e,t,a){console.error(e,t,a),this.setState({isLoaded:!0,error:a.toString()})}.bind(this)})}},{key:"render",value:function(){var e=this;return this.state.error?c.a.createElement("div",null,"Error: ",this.state.error):this.state.isLoaded?c.a.createElement(c.a.Fragment,null,c.a.createElement(u.a,{classNameMenu:"scrollable-GRAXObjectCombobox",events:{onChange:function(t,a){var i=a.value;e.setState({inputValue:i}),e.props.onChange&&e.props.onChange(t,i)},onRequestRemoveSelectedOption:function(t,a){e.setState({inputValue:"",selection:a.selection}),e.props.onRequestRemoveSelectedOption&&e.props.onRequestRemoveSelectedOption(t,a.selection)},onSelect:function(t,a){e.setState({inputValue:"",selection:a.selection}),e.props.onSelect&&e.props.onSelect(t,a.selection)}},labels:{placeholder:"Search GRAX Table"},options:Object(g.e)({inputValue:this.state.inputValue,limit:1e3,options:this.state.options,selection:this.state.selection}),selection:this.state.selection,value:this.state.inputValue,variant:"inline-listbox",required:!0})):c.a.createElement("div",{style:{position:"relative",height:"2rem"}},c.a.createElement(d.a,{size:"small",variant:"base"}))}}]),t}(c.a.Component)}}]);
//# sourceMappingURL=8.1bdbc240.chunk.js.map