(this.webpackJsonpgraxreact=this.webpackJsonpgraxreact||[]).push([[12],{282:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var s=a(21),n=a(46),i=a(35),l=a(29),r=a(90),o=a(34),c=a(0),p=a.n(c),u=a(9),d=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={isOpen:!0===e.isOpen||void 0===e.isCollapsible},a.handleToggle=a.handleToggle.bind(Object(r.a)(a)),a}return Object(o.a)(t,e),Object(n.a)(t,[{key:"handleToggle",value:function(e){var t=!this.state.isOpen;this.setState({isOpen:t}),this.props.onToggle&&this.props.onToggle(t),e.preventDefault()}},{key:"render",value:function(){var e=p.a.createElement("span",{className:"slds-truncate"+(this.props.isCollapsible?"":" slds-p-horizontal_small"),title:this.props.title},this.props.title);return p.a.createElement("div",{id:this.props.id||this.props.key,className:["slds-section",this.state.isOpen&&"slds-is-open",this.props.className].join(" ")},p.a.createElement("h3",{className:"slds-section__title slds-theme_shade"},this.props.isCollapsible?p.a.createElement("button",{className:"slds-button slds-section__title-action",onClick:this.handleToggle},p.a.createElement(u.a,{assistiveText:{label:this.props.title},category:"utility",name:"switch",size:"x-small",className:"slds-section__title-action-icon slds-button__icon slds-button__icon_left"}),e):e),this.state.isOpen&&p.a.createElement("div",{className:"slds-section__content"},this.props.children))}}]),t}(p.a.Component)},295:function(e,t,a){"use strict";a.r(t);var s=a(6),n=a(21),i=a(46),l=a(35),r=a(29),o=a(34),c=a(0),p=a.n(c),u=a(36),d=a.n(u),h=a(282),m=a(66),f=a(269),g=a(280),b=a(22),v=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(l.a)(this,Object(r.a)(t).call(this,e))).state={options:[],inputValue:"",selection:[],isLoaded:!1,error:null},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){g.a.ajax({type:"GET",url:g.c+"/grax-app/grax-data-lake/salesforce/describeGlobal/sobjects"+Object(g.b)({action:"load"}),data:{_bools:"createable,layoutable,triggerable",_select:"name,label"},success:function(e){var t=this;this.setState({options:d.a.map(e,(function(e,t){return{id:e.name,label:e.label,index:"grax"+e.name.toLowerCase()+"index"}})),isLoaded:!0}),null!=this.props.selectionKeys&&this.setState({selection:d.a.filter(this.state.options,(function(e){return-1!==t.props.selectionKeys.indexOf(e.index)||-1!==t.props.selectionKeys.indexOf(e.id)}))}),this.props.onLoad&&this.props.onLoad(!0),this.props.onSelect&&null!=this.state.selection&&this.state.selection.length>0&&this.props.onSelect(null,this.state.selection)}.bind(this),error:function(e,t,a){console.error(e,t,a),this.setState({isLoaded:!0,error:a.toString()}),this.props.onLoad&&this.props.onLoad(!1,a)}.bind(this)})}},{key:"render",value:function(){var e=this;return this.state.error?p.a.createElement("div",null,"Error: ",this.state.error):this.state.isLoaded?p.a.createElement(p.a.Fragment,null,p.a.createElement(f.a,{classNameMenu:"scrollable-GRAXSObjectCombobox",events:{onChange:function(t,a){var s=a.value;e.setState({inputValue:s}),e.props.onChange&&e.props.onChange(t,s)},onRequestRemoveSelectedOption:function(t,a){return!(!e.props.onRequestRemoveSelectedOption||!e.props.onRequestRemoveSelectedOption(t,a.selection))&&(e.setState({inputValue:"",selection:a.selection}),!0)},onSelect:function(t,a){e.setState({inputValue:"",selection:a.selection}),e.props.onSelect&&e.props.onSelect(t,a.selection)}},labels:{placeholder:"Select Salesforce Object"},options:Object(b.e)({inputValue:this.state.inputValue,limit:1e3,options:this.state.options,selection:this.state.selection}),selection:this.state.selection,value:this.state.inputValue,variant:"inline-listbox",required:!0,menuItem:this.props.menuItem})):p.a.createElement("div",{style:{position:"relative",height:"2rem"}},p.a.createElement(m.a,{size:"small",variant:"base"}))}}]),t}(p.a.Component),O=a(76),_=a(17),y=a(275),S=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(l.a)(this,Object(r.a)(t).call(this,e))).state={options:[],inputValue:"",selection:[],isLoaded:!1,error:null},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){g.a.ajax({type:"GET",url:g.c+"/grax-app/grax-data-lake/getOrgList"+Object(g.b)({action:"load"}),data:{},success:function(e){this.setState({options:d.a.map(e,(function(e,t){return{id:e.id,label:e.id+" ("+e.label+")"}})),isLoaded:!0}),this.props.onLoad&&this.props.onLoad(!0)}.bind(this),error:function(e,t,a){console.error(e,t,a),this.setState({isLoaded:!0,error:a.toString()}),this.props.onLoad&&this.props.onLoad(!1,a)}.bind(this)})}},{key:"render",value:function(){var e=this;return this.state.error?p.a.createElement("div",null,"Error: ",this.state.error):this.state.isLoaded?p.a.createElement(p.a.Fragment,null,p.a.createElement(f.a,{classNameMenu:"scrollable-GRAXOrgCombobox",events:{onChange:function(t,a){var s=a.value;e.setState({inputValue:s}),e.props.onChange&&e.props.onChange(t,s)},onRequestRemoveSelectedOption:function(t,a){e.setState({inputValue:"",selection:a.selection}),e.props.onRequestRemoveSelectedOption&&e.props.onRequestRemoveSelectedOption(t,a.selection)},onSelect:function(t,a){e.setState({inputValue:"",selection:a.selection}),e.props.onSelect&&e.props.onSelect(t,a.selection)}},labels:{placeholder:"Select Salesforce Org"},options:Object(b.e)({inputValue:this.state.inputValue,limit:1e3,options:this.state.options,selection:this.state.selection}),selection:this.state.selection,value:this.state.inputValue,variant:"inline-listbox",required:!0})):p.a.createElement("div",{style:{position:"relative",height:"2rem"}},p.a.createElement(m.a,{size:"small",variant:"base"}))}}]),t}(p.a.Component),E=a(296),k=a(149),C=a(9),F="All fields",M=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(l.a)(this,Object(r.a)(t).call(this,e))).state={checked:F},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"onChangeHandler",value:function(e){console.log("onChangeHandler"),console.log(e),this.setState({checked:e}),this.props.onChange&&this.props.onChange(e)}},{key:"render",value:function(){var e=this,t=["Mapped Fields","Un-mapped fields",F];return p.a.createElement("div",{className:"slds-p-bottom_medium"},p.a.createElement(E.a,{onChange:function(t){return e.onChangeHandler(t.target.value)},disabled:this.props.disabled,required:this.props.required,name:this.props.name,errorId:this.props.errorId},d.a.map(t,function(e,t){return p.a.createElement(k.a,{key:"option"+t,id:e,label:e,value:e,checked:this.state.checked===e,variant:"button-group",deselectable:!0})}.bind(this))))}}]),t}(p.a.Component),j=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(l.a)(this,Object(r.a)(t).call(this,e))).state={inputValue:"",selection:[],isOpened:!1},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.selection&&this.setState({selection:this.props.selection})}},{key:"filterOptionsHandler",value:function(){var e=this.props.options;return this.props.filterOptionsHandler&&this.state.isOpened&&(e=this.props.filterOptionsHandler(e)),Object(b.e)({inputValue:this.state.inputValue,limit:1e3,options:e,selection:this.state.selection})}},{key:"render",value:function(){var e=this;return p.a.createElement(p.a.Fragment,null,p.a.createElement(f.a,{classNameMenu:"scrollable-GRAXRestoreMappingDataLakeField",events:{onChange:function(t,a){var s=a.value;e.setState({inputValue:s}),e.props.onChange&&e.props.onChange(t,s)},onRequestRemoveSelectedOption:function(t,a){e.setState({inputValue:"",selection:a.selection}),e.props.onRequestRemoveSelectedOption&&e.props.onRequestRemoveSelectedOption(t,a.selection)},onSelect:function(t,a){e.setState({inputValue:"",selection:a.selection}),e.props.onSelect&&e.props.onSelect(t,a.selection)},onOpen:function(t,a){e.setState({isOpened:!0})},onClose:function(t,a){e.setState({isOpened:!1})}},labels:{placeholder:"Select DataLake Field"},options:this.filterOptionsHandler(),selection:this.state.selection,value:this.state.inputValue,variant:"readonly",hasStaticAlignment:!0,multiple:!0}))}}]),t}(p.a.Component),x=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(l.a)(this,Object(r.a)(t).call(this,e))).state={_graxFieldOptions:null,_graxFieldOptionsList:null,_sfFieldOptions:null,_sfFieldOptionsList:null,_sfMappedFields:null,_error:null,_filterSelection:F,isPreviouslyMapped:!1},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"isLoaded",value:function(){return this.state._error||null!=this.state._graxFieldOptions&&null!=this.state._sfFieldOptions}},{key:"componentDidMount",value:function(){var e=d.a.map(this.props.graxFieldOptions,(function(e,t){return e.id})),t=this.props.sfMappedFields||{},a=this.props.sfFieldOptions;d.a.forEach(a,(function(a,s){var n=d.a.reduce(t[a.id]||[a.id],(function(t,a){return-1!==e.indexOf(a)&&t.push(a),t}),[]);n.length>0&&(t[a.id]=n)})),this.setState({_graxFieldOptions:this.props.graxFieldOptions,_graxFieldOptionsList:e,_sfFieldOptions:a,_sfMappedFields:t,sfMappedFieldsList:Object.keys(t),graxMappedFieldsList:d.a.flatten(d.a.values(t))})}},{key:"shouldComponentUpdate",value:function(e,t){return this.state._filterSelection!==t._filterSelection||this.props.objectName!==e.objectName||this.state._graxFieldOptions!==t._graxFieldOptions||this.state._sfFieldOptions!==t._sfFieldOptions||this.props.graxFieldOptions!==e.graxFieldOptions||this.props.sfFieldOptions!==e.sfFieldOptions||this.props.sfMappedFields!==e.sfMappedFields||this.props.renderKey!==e.renderKey}},{key:"onMappingChangeHandler",value:function(e,t){var a=d.a.map(t,(function(e,t){return e.id})),s=this.state._sfMappedFields;t?s[e]=a:delete s[e],this.setState({_sfMappedFields:s,sfMappedFieldsList:Object.keys(s),graxMappedFieldsList:d.a.flatten(d.a.values(s))}),this.props.onMappingChange&&this.props.onMappingChange(e,a)}},{key:"render",value:function(){var e=this;if(this.state._error)return p.a.createElement("div",null,"Error: ",this.state._error);if(this.isLoaded()){var t=this.state._sfFieldOptions;return"Mapped Fields"===this.state._filterSelection&&(t=d.a.filter(t,(function(t,a){return null!=e.state._sfMappedFields&&-1!==e.state.sfMappedFieldsList.indexOf(t.id)&&0!==e.state._sfMappedFields[t.id].length}))),"Un-mapped fields"===this.state._filterSelection&&(t=d.a.filter(t,(function(t,a){return-1===e.state.sfMappedFieldsList.indexOf(t.id)||null==e.state._sfMappedFields[t.id]||0===e.state._sfMappedFields[t.id].length}))),t=d.a.sortBy(t,["id"]),p.a.createElement(p.a.Fragment,null,p.a.createElement(M,{onChange:function(t){return e.setState({_filterSelection:t})}}),p.a.createElement("div",{className:"slds-scrollable_y",style:{maxHeight:"50vw"}},p.a.createElement("table",{className:"slds-table slds-table_cell-buffer slds-table_bordered slds-no-row-hover"},p.a.createElement("thead",null,p.a.createElement("tr",{className:"slds-line-height_reset"},this.state._filterSelection===F&&p.a.createElement("th",{className:"slds-text-title_caps",scope:"col"},p.a.createElement("div",{className:"slds-truncate",title:"Is Mapped?"},"Is Mapped?")),p.a.createElement("th",{className:"slds-text-title_caps",scope:"col"},p.a.createElement("div",{className:"slds-truncate",title:"Datalake Field"},"Datalake Field")),p.a.createElement("th",{className:"slds-text-title_caps",scope:"col"},p.a.createElement("div",{className:"slds-truncate",title:"Salesforce Field"},"Salesforce Field")))),p.a.createElement("tbody",null,d.a.map(t,function(e,t){var a=this,s=e.id;return p.a.createElement("tr",{className:"slds-hint-parent",key:s},this.state._filterSelection===F&&p.a.createElement("td",{"data-label":"Is Mapped?",style:{width:"10vw"}},null!=this.state._sfMappedFields[s]&&this.state._sfMappedFields[s].length>0&&p.a.createElement(C.a,{category:"utility",color:"warning",name:"check",size:"x-small"})),p.a.createElement("td",{"data-label":"Salesforce Field",style:{width:"60vw"}},p.a.createElement(j,{options:this.state._graxFieldOptions,filterOptionsHandler:function(t){return d.a.filter(t,(function(t,s){return-1===a.state.graxMappedFieldsList.indexOf(t.id)&&e.type===t.type}))},selection:d.a.map(this.state._sfMappedFields[s],(function(e,t){return{id:e,label:e}})),onSelect:function(e,t){return a.onMappingChangeHandler(s,t)},onRequestRemoveSelectedOption:function(e,t){return a.onMappingChangeHandler(s,t)}})),p.a.createElement("td",{"data-label":"Datalake Field",style:{width:"30vw"}},p.a.createElement("div",{className:"slds-truncate",title:e.id},e.id)))}.bind(this))))))}return p.a.createElement("div",{style:{position:"relative",height:"5rem"}},p.a.createElement(m.a,{size:"small",variant:"base"}))}}]),t}(p.a.Component),V=a(59),D=a(254),R=a(297),N=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(l.a)(this,Object(r.a)(t).call(this,e)))._isMounted=!1,a.state={inputValue:"",selection:[],isOpened:!1},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this._isMounted=!0,this.props.selection&&this.setState({selection:this.props.selection})}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"filterOptionsHandler",value:function(){var e=this.props.options;return this.props.filterOptionsHandler&&this.state.isOpened&&(e=this.props.filterOptionsHandler(e)),Object(b.e)({inputValue:this.state.inputValue,limit:1e3,options:e,selection:this.state.selection})}},{key:"render",value:function(){var e=this;return p.a.createElement(p.a.Fragment,null,p.a.createElement(f.a,Object(s.a)({classNameMenu:"scrollable-GRAXRestoreMappingSFField",events:{onChange:function(t,a){var s=a.value;e._isMounted&&e.setState({inputValue:s}),e.props.onChange&&e.props.onChange(t,s)},onRequestRemoveSelectedOption:function(t,a){e._isMounted&&e.setState({inputValue:"",selection:a.selection}),e.props.onRequestRemoveSelectedOption&&e.props.onRequestRemoveSelectedOption(t,a.selection)},onSelect:function(t,a){e._isMounted&&e.setState({inputValue:"",selection:a.selection}),e.props.onSelect&&e.props.onSelect(t,a.selection)},onRequestOpen:function(t,a){e._isMounted&&e.setState({isOpened:!0})},onRequestClose:function(t,a){e._isMounted&&e.setState({isOpened:!1})}},labels:{placeholder:"Select SalesForce Field"},options:this.filterOptionsHandler(),selection:this.state.selection,value:this.state.inputValue,variant:"readonly",menuPosition:"overflowBoundaryElement",hasStaticAlignment:!0,isOpen:this.state.isOpened},"hasStaticAlignment",!0)))}}]),t}(p.a.Component),L=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(l.a)(this,Object(r.a)(t).call(this,e))).state={_sfFieldOptions:null,_sfFieldOptionsList:null,_sfDefaultValues:null,_mappingOptions:[{id:"DEFAULT",label:"Default To"},{id:"MASK",label:"Mask"}],_maskOptionsString:[{id:"STRING",label:"Mask the last 4 with XXXX"},{id:"STRINGRND",label:"Randomize"}],_maskOptionsPhone:[{id:"PHONE",label:"Mask the last 4 with XXXX"},{id:"PHONERND",label:"Randomize"}],_maskOptionsEmail:[{id:"EMAIL",label:"Mask the domain with @maskeddomain.com"},{id:"EMAILRND",label:"Randomize"}],_maskOptionsDate:[{id:"DATE",label:"Mask the year with 2000"},{id:"DATERND",label:"Randomize"}],_error:null},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"isLoaded",value:function(){return this.state._error||null!=this.state._sfFieldOptions}},{key:"getDefaultValueStruct",value:function(){return{id:null,mapping:[this.state._mappingOptions[0]],masking:null,value:null,isOverride:!1,selectedField:null}}},{key:"getDefaultValuesList",value:function(e){var t=this;return d.a.map(e,(function(e,a){var s=t.getDefaultValueStruct();s.id=a,s.mapping=d.a.filter(t.state._mappingOptions,(function(t,a){return t.id===e.mapping})),s.mapping||(s.mapping=[t.state._mappingOptions[0]]);var n=[];return t.state._maskOptionsString.forEach((function(e){n.push(e)})),t.state._maskOptionsPhone.forEach((function(e){n.push(e)})),t.state._maskOptionsEmail.forEach((function(e){n.push(e)})),t.state._maskOptionsDate.forEach((function(e){n.push(e)})),s.masking=d.a.filter(n,(function(t,a){return t.id===e.masking})),s.value=e.value,s.isOverride=e.override,s.selectedField=d.a.filter(t.state._sfFieldOptions||t.props.sfFieldOptions,(function(e,t){return e.id===a}))[0]||null,s}))}},{key:"componentDidMount",value:function(){var e=this.props.sfDefaultValues||{};this.setState({_sfFieldOptions:this.props.sfFieldOptions,_sfDefaultValues:e,_sfDefaultValuesFields:Object.keys(e),_sfDefaultValuesList:this.getDefaultValuesList(e)})}},{key:"onDefaultValueChangeHandler",value:function(e,t){var a=this.state._sfDefaultValues;if(t){var s=t[0];e.id=s.id,e.selectedField=s,a[e.id]={mapping:e.mapping&&e.mapping.length>0?e.mapping[0].id:"",masking:e.masking&&e.masking.length>0?e.masking[0].id:"",value:e.value,override:e.isOverride}}else delete a[e.id],e.id=null,e.selectedField=null;this.setState({_sfDefaultValues:a,_sfDefaultValuesFields:Object.keys(a),_sfDefaultValuesList:this.state._sfDefaultValuesList}),this.props.onDefaultValueChangeHandler&&this.props.onDefaultValueChangeHandler(a)}},{key:"addAnotherFieldHandler",value:function(){var e=this.state._sfDefaultValuesList;0!==e.length&&null==e[e.length-1].id||(e.push(this.getDefaultValueStruct()),this.setState({_sfDefaultValuesList:e}))}},{key:"removeFieldHandler",value:function(e){var t=this.state._sfDefaultValues,a=this.state._sfDefaultValuesList;delete t[a[e].id],a.splice(e,1),this.setState({_sfDefaultValues:t,_sfDefaultValuesFields:Object.keys(t),_sfDefaultValuesList:a})}},{key:"render",value:function(){var e=this;return this.state._error?p.a.createElement("div",null,"Error: ",this.state._error):this.isLoaded()?p.a.createElement(p.a.Fragment,null,p.a.createElement("table",{className:"slds-table slds-table_cell-buffer slds-table_bordered slds-no-row-hover"},p.a.createElement("thead",null,p.a.createElement("tr",{className:"slds-line-height_reset"},p.a.createElement("th",{className:"slds-text-title_caps",scope:"col"},p.a.createElement("div",{className:"slds-truncate",title:"Salesforce Field"},"Salesforce Field")),p.a.createElement("th",{className:"slds-text-title_caps",scope:"col"},p.a.createElement("div",{className:"slds-truncate",title:"Option"},"Option",p.a.createElement("div",{style:{texttransform:"none",display:"inline"}},p.a.createElement(V.a,{align:"top left",position:"overflowBoundaryElement",content:'Default To - Set a value which will be used for this field on all records. Mask - Select one of the options from the "Value" picklist'},p.a.createElement("div",{style:{marginRight:"0.5rem",cursor:"pointer"}},p.a.createElement(C.a,{assistiveText:{label:"MAPPING"},category:"utility",name:"info",size:"x-small"})))))),p.a.createElement("th",{className:"slds-text-title_caps",scope:"col"},p.a.createElement("div",{className:"slds-truncate",title:"Value"},"Value")),p.a.createElement("th",{className:"slds-text-title_caps",scope:"col"},p.a.createElement("div",{className:"slds-truncate",title:"Is Override?"},"Is Override?",p.a.createElement("div",{style:{texttransform:"none",display:"inline"}},p.a.createElement(V.a,{align:"top right",position:"overflowBoundaryElement",content:"If this checkbox is FALSE, the default value set here will only override blank fields. If this checkbox is TRUE, the default value set will override even populated fields."},p.a.createElement("div",{style:{marginRight:"0.5rem",cursor:"pointer"}},p.a.createElement(C.a,{assistiveText:{label:"Is Override?"},category:"utility",name:"info",size:"x-small"})))))),p.a.createElement("th",{className:"slds-text-title_caps",scope:"col"},p.a.createElement("div",{className:"slds-truncate"})))),p.a.createElement("tbody",null,d.a.map(this.state._sfDefaultValuesList,function(e,t){var a=this;console.log(e,t);var s=e.id,n=e.selectedField;return p.a.createElement("tr",{className:"slds-hint-parent",key:"sfFieldName: "+(s||"")},p.a.createElement("td",{"data-label":"Salesforce Field",style:{width:"35vw"}},s||p.a.createElement(N,{options:this.state._sfFieldOptions,filterOptionsHandler:function(e){return d.a.filter(e,(function(e,t){return-1===a.state._sfDefaultValuesFields.indexOf(e.id)}))},selection:[d.a.find(this.state._sfFieldOptions,(function(e){return e.id===s}))],onSelect:function(t,s){return a.onDefaultValueChangeHandler(e,s)},onRequestRemoveSelectedOption:function(t,s){return a.onDefaultValueChangeHandler(e,s)}})),p.a.createElement("td",{"data-label":"Value",style:{width:"20vw"}},n&&"text"!==n.type&&"date"!==n.type&&this.state._mappingOptions[0]&&this.state._mappingOptions[0].label,n&&("text"===n.type||"date"===n.type)&&p.a.createElement(N,{options:this.state._mappingOptions,filterOptionsHandler:function(e){return a.state._mappingOptions},selection:e.mapping,onSelect:function(t,s){e.mapping=s,e.isOverride=!1,a.onDefaultValueChangeHandler(e,[e.selectedField])},onRequestRemoveSelectedOption:function(t,s){e.mapping=s,a.onDefaultValueChangeHandler(e,[e.selectedField])}})),p.a.createElement("td",{"data-label":"Value",style:{width:"35vw"}},n&&e.mapping&&e.mapping[0]&&"DEFAULT"===e.mapping[0].id&&(("text"===n.type||"number"===n.type)&&p.a.createElement(D.a,{defaultValue:e.value,assistiveText:{label:n.label},id:n.id,onBlur:function(t){e.value=t.target.value,a.onDefaultValueChangeHandler(e,[e.selectedField])}})||"date"===n.type&&p.a.createElement(R.a,{value:e.value,onChange:function(t,s){e.value=s.date,a.onDefaultValueChangeHandler(e,[e.selectedField])}})||"boolean"===n.type&&p.a.createElement(O.a,{defaultChecked:e.value,onChange:function(t){t.persist(),e.value=t.target.checked,a.onDefaultValueChangeHandler(e,[e.selectedField])}})),n&&e.mapping&&e.mapping[0]&&"MASK"===e.mapping[0].id&&"sfType:"+n&&p.a.createElement(N,{options:"phone"===n.sfType?this.state._maskOptionsPhone:"email"===n.sfType?this.state._maskOptionsEmail:"date"===n.type?this.state._maskOptionsDate:this.state._maskOptionsString,filterOptionsHandler:function(e){return"phone"===n.sfType?a.state._maskOptionsPhone:"email"===n.sfType?a.state._maskOptionsEmail:"date"===n.type?a.state._maskOptionsDate:a.state._maskOptionsString},selection:e.masking,onSelect:function(t,s){e.masking=s,a.onDefaultValueChangeHandler(e,[e.selectedField])},onRequestRemoveSelectedOption:function(t,s){e.masking=s,a.onDefaultValueChangeHandler(e,[e.selectedField])}})),p.a.createElement("td",{"data-label":"Is Override?",style:{width:"10vw"}},e.mapping&&null==e.mapping[0]||"MASK"!==e.mapping[0].id?p.a.createElement(O.a,{key:"checkbox_enabled",defaultChecked:e.isOverride,onChange:function(t){t.persist(),e.isOverride=t.target.checked,a.onDefaultValueChangeHandler(e,[e.selectedField])}}):p.a.createElement(O.a,{key:"checkbox_disabled",value:!1,disabled:!0})),p.a.createElement("td",{"data-label":"Actions",style:{width:"10vw"}},p.a.createElement(_.a,{label:"Remove Field",variant:"base",onClick:function(){a.removeFieldHandler(t)}})))}.bind(this)))),p.a.createElement("div",{className:"slds-p-top_medium"},p.a.createElement(_.a,{label:"Add Field",variant:"brand",onClick:function(){e.addAnotherFieldHandler()}}))):p.a.createElement("div",{style:{position:"relative",height:"5rem"}},p.a.createElement(m.a,{size:"small",variant:"base"}))}}]),t}(p.a.Component);function w(e){var t;switch(e){case"date":case"datetime":t="date";break;case"boolean":t="boolean";break;case"double":case"long":case"percent":case"currency":t="number";break;default:t="text"}return t}a.d(t,"default",(function(){return H}));var T="Some changes have not been saved, do you want to continue?",H=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(l.a)(this,Object(r.a)(t).call(this,e))).state={selectedSObject:null,_graxFieldOptions:null,_sfFieldOptions:null,_sfMappedFields:{},_sfDefaultValues:{},_error:null,isLoading:!0,_isCustomOrg:!1,_customOrg:null,customMapping:null,hasChanges:!1,isSaving:!1,resetConfirmIsOpen:!1,resetConfirmIsChecked:!1,resetConfirmCallback:function(){return{}},renderCounter:0},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"_onMappingChangeHandler",value:function(e,t){console.log(e,t);var a=this.state._sfMappedFields;a[e]=t,this.setState({_sfMappedFields:a,hasChanges:!0})}},{key:"_onOrgSelectionChangeHandler",value:function(e){console.log(e);var t=e[0]||null;this.state._customOrg===t||this.state.hasChanges&&!confirm(T)||(this.setState({_customOrg:t}),this.onMappingSettingsChange(this.state.selectedSObject,this.state.customMapping))}},{key:"_onOrgSelectionRemoveHandler",value:function(e){var t=e[0]||null;this.state._customOrg===t||this.state.hasChanges&&!confirm(T)||this.setState({_customOrg:t,_sfMappedFields:{},_sfDefaultValues:{}})}},{key:"isMapLoaded",value:function(){return this.state._error||null!=this.state.customMapping&&null!=this.state._graxFieldOptions&&null!=this.state._sfFieldOptions&&null!=this.state._sfDefaultValues}},{key:"componentDidMount",value:function(){this.setState({customMapping:this.props.customMapping})}},{key:"onMappingSettingsChange",value:function(e,t){var a=this.state.customMapping[e]||{};this.state._isCustomOrg&&this.state._customOrg&&(a=a[this.state._customOrg]||{});var s=a.fieldMap||{};this.setState({_sfFieldOptions:d.a.map(t,(function(e,t){return{id:e.name,label:e.name,type:w(e.type),sfType:e.type}})),_sfMappedFields:d.a.omit(s,["__defaultValues__"])||{},_sfDefaultValues:s.__defaultValues__||{}})}},{key:"sObjectChangeHandler",value:function(e){g.a.ajax({type:"GET",url:g.c+"/grax-app/grax-data-lake/salesforce/sobjects/"+e+"/fields"+Object(g.b)({action:"load"}),data:{_bools:"createable",_select:"name,type"},success:function(t){this.onMappingSettingsChange(e,t)}.bind(this),error:function(e,t,a){console.error(e,t,a),this.setState({_error:a.toString()})}.bind(this)}),g.a.ajax({type:"GET",url:g.c+"/grax-app/grax-data-lake/getDataTypeFields/grax"+e.toLowerCase()+"index"+Object(g.b)({action:"load"}),data:{},success:function(e){this.setState({_graxFieldOptions:d.a.map(e,(function(e,t){return{id:t,label:t,type:w(e)}}))})}.bind(this),error:function(e,t,a){console.error(e,t,a),this.setState({_error:a.toString()})}.bind(this)})}},{key:"getCustomMappingToSave",value:function(){console.log("this.state.customMapping",this.state.customMapping);var e=this.state._sfMappedFields,t={fieldMap:d.a.reduce(e,(function(e,t,a){return d.a.isArray(t)&&1===t.length&&t[0]===a||(e[a]=t),e}),{})};return d.a.isEmpty(this.state._sfDefaultValues)||(t.fieldMap.__defaultValues__=this.state._sfDefaultValues),this.state._isCustomOrg&&this.state._customOrg&&(t=d.a.assign({},this.state.customMapping[this.state.selectedSObject.id]||{},Object(s.a)({},this.state._customOrg,t))),console.log("customMapping",t),d.a.assign({},this.state.customMapping,Object(s.a)({},this.state.selectedSObject.id,t))}},{key:"saveCustomMapping",value:function(e){console.log("customMappingToSave",e),this.setState({isSaving:!0}),g.a.ajax({type:"POST",url:g.c+"/grax-app/grax-data-lake/saveCustomMapping"+Object(g.b)({action:"save"}),contentType:"application/json; charset=utf-8",data:JSON.stringify(e),success:function(t){console.log(t),this.setState({customMapping:e,hasChanges:!1,isSaving:!1}),this.props.onMappingChange&&this.props.onMappingChange(e)}.bind(this),error:function(e,t,a){console.error(e,t,a),this.setState({_error:a.toString(),isSaving:!1})}.bind(this)})}},{key:"render",value:function(){var e=this;return(p.a.createElement("div",null,this.state.isSaving&&p.a.createElement(m.a,{size:"large",variant:"brand"}),p.a.createElement(h.a,{isCollapsible:!0,isOpen:!0,title:"Select your Salesforce Object"},this.state._error||p.a.createElement(v,{menuItem:function(t){return e.state.customMapping[t.option.id]?p.a.createElement("b",null,t.option.id):t.option.id},onSelect:function(t,a){var s=a[0];e.setState({selectedSObject:s}),e.sObjectChangeHandler(s.id)},onRequestRemoveSelectedOption:function(t,a){return!(e.state.hasChanges&&!confirm(T))&&(e.setState({selectedSObject:null,_graxFieldOptions:null,_sfFieldOptions:null,hasChanges:!1}),!0)},onLoad:function(t,a){e.setState({isLoading:!1,_error:a?a.toString:null})},selectionKeys:null!=g.e.datalakeIndex?[g.e.datalakeIndex]:null}),!this.state.isLoading&&p.a.createElement(O.a,{className:"slds-p-top_medium",labels:{label:"Would you like to define a custom field Mapping for a source Organization?"},onChange:function(t){t.persist(),e.setState({_isCustomOrg:t.target.checked})}}),this.state._isCustomOrg&&p.a.createElement("div",{style:{maxWidth:"50vw"}},p.a.createElement(S,{onSelect:function(t,a){return e._onOrgSelectionChangeHandler(a)},onRequestRemoveSelectedOption:function(t,a){return e._onOrgSelectionRemoveHandler(a)}})),p.a.createElement("div",{className:"slds-m-bottom_large"})),p.a.createElement(h.a,{isCollapsible:!0,isOpen:!0,title:"Map the fields to the appropriate Salesforce field"},this.state.selectedSObject&&(this.isMapLoaded()?p.a.createElement(x,{key:"GRAXRestoreMappingFields_"+this.state.renderCounter,renderKey:"GRAXRestoreMappingFields_"+this.state.renderCounter,objectName:this.state.selectedSObject.id,graxFieldOptions:this.state._graxFieldOptions,sfFieldOptions:this.state._sfFieldOptions,sfMappedFields:this.state._sfMappedFields,onMappingChange:this._onMappingChangeHandler.bind(this)}):p.a.createElement("div",{style:{position:"relative",height:"5rem"}},p.a.createElement(m.a,{size:"medium",variant:"brand"}))),p.a.createElement("div",{className:"slds-m-bottom_large"})),p.a.createElement(h.a,{isCollapsible:!0,isOpen:!0,title:"Set a default field value for fields on this object"},this.state.selectedSObject&&(this.isMapLoaded()?p.a.createElement(L,{key:"GRAXRestoreMappingDefaults_"+this.state.renderCounter,renderKey:"GRAXRestoreMappingDefaults_"+this.state.renderCounter,objectName:this.state.selectedSObject.id,sfFieldOptions:this.state._sfFieldOptions,sfDefaultValues:this.state._sfDefaultValues,onDefaultValueChangeHandler:function(t){console.log(t),e.setState({_sfDefaultValues:t,hasChanges:!0})}}):p.a.createElement("div",{style:{position:"relative",height:"5rem"}},p.a.createElement(m.a,{size:"medium",variant:"brand"}))),p.a.createElement("div",{className:"slds-m-bottom_large"})),p.a.createElement("div",{style:{"margin-bottom":"25rem"}},this.state.selectedSObject&&this.isMapLoaded()&&p.a.createElement(p.a.Fragment,null,p.a.createElement(_.a,{label:"Save",variant:"brand",onClick:function(){var t=e.getCustomMappingToSave();e.saveCustomMapping(t)}}),this.state.customMapping&&this.state.customMapping[this.state.selectedSObject.id]&&p.a.createElement(_.a,{label:"Reset Mapping",variant:"destructive",onClick:function(){e.setState({resetConfirmIsOpen:!0,resetConfirmIsChecked:!1,resetConfirmCallback:function(){if(e.state.resetConfirmIsChecked&&confirm("Are you sure that you want to reset the selected mapping?")){e.setState({_sfMappedFields:{},_sfDefaultValues:{},renderCounter:e.state.renderCounter+1,resetConfirmIsOpen:!1,resetConfirmCallback:function(){}});var t=e.getCustomMappingToSave();t[e.state.selectedSObject.id]&&delete t[e.state.selectedSObject.id],e.saveCustomMapping(t)}}})}}))),this.state.selectedSObject&&this.isMapLoaded()&&p.a.createElement(y.a,{dismissible:!0,footer:[p.a.createElement("div",{key:"resetCheck",className:"slds-p-bottom_small"},p.a.createElement(O.a,{assistiveText:{label:"I understand the risks"},id:"reset-confirm",labels:{label:"I understand the risks"},onChange:function(t){t.persist(),e.setState({resetConfirmIsChecked:t.target.checked})}})),p.a.createElement(_.a,{key:"cancelBtn",label:"Cancel",onClick:function(){e.setState({resetConfirmIsOpen:!1,resetConfirmIsChecked:!1})}}),p.a.createElement(_.a,{key:"resetBtn",label:"Reset",onClick:this.state.resetConfirmCallback,variant:"destructive",disabled:!this.state.resetConfirmIsChecked})],isOpen:this.state.resetConfirmIsOpen,onRequestClose:function(){e.setState({resetConfirmIsOpen:!1,resetConfirmIsChecked:!1})},prompt:"error",size:"medium",title:p.a.createElement("span",null,"Reset ",p.a.createElement("b",null,this.state.selectedSObject.id)," mapping?")},p.a.createElement("div",{className:"slds-m-around_medium"},"Removing the mapping will set the mapping back to the default values.",p.a.createElement("br",null),"Once a mapping has been reset, it cannot be restored."))))}}]),t}(p.a.Component)},296:function(e,t,a){"use strict";var s=a(0),n=a.n(s),i=a(1),l=a.n(i),r=a(2),o=a.n(r),c=a(11),p=a.n(c),u=a(18),d=a.n(u),h=a(4);function m(e){return(m="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function g(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function b(e,t){return!t||"object"!==m(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _={assistiveText:l.a.shape({label:l.a.string,required:l.a.string}),children:l.a.node.isRequired,className:l.a.oneOfType([l.a.array,l.a.object,l.a.string]),labels:l.a.shape({error:l.a.string,label:l.a.string}),onChange:l.a.func,disabled:l.a.bool,required:l.a.bool,name:l.a.string,errorId:l.a.string,variant:l.a.oneOf(["base","button-group"])},y={assistiveText:{required:"Required"},labels:{},variant:"base"},S=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=b(this,v(t).call(this,e))).generatedName=p.a.generate(),a.generatedErrorId=p.a.generate(),a}var a,s,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(t,e),a=t,(s=[{key:"getErrorId",value:function(){if(this.hasError())return this.props.errorId||this.generatedErrorId}},{key:"getName",value:function(){return this.props.name||this.generatedName}},{key:"hasError",value:function(){return!!this.labels.error}},{key:"render",value:function(){var e=this;this.labels=this.props.labels?d()({},y.labels,this.props.labels):y.labels;var t=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},s=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),s.forEach((function(t){f(e,t,a[t])}))}return e}({},y.assistiveText,this.props.assistiveText),a=n.a.Children.map(this.props.children,(function(t){return n.a.cloneElement(t,{name:e.getName(),onChange:e.props.onChange,"aria-describedby":e.getErrorId(),disabled:e.props.disabled})}));return n.a.createElement("fieldset",{className:o()("slds-form-element",{"slds-has-error":this.labels.error})},n.a.createElement("legend",{className:o()("slds-form-element__legend","slds-form-element__label",t.label?"slds-assistive-text":"")},this.props.required?n.a.createElement("abbr",{className:"slds-required",title:"required"},"*",n.a.createElement("div",{className:"slds-assistive-text"},t.required," ")):null,t.label?t.label:this.labels.label),n.a.createElement("div",{className:o()("slds-form-element__control",this.props.className)},"button-group"===this.props.variant?n.a.createElement("div",{style:this.props.style,className:"slds-radio_button-group"},a):a,this.labels.error?n.a.createElement("div",{id:this.getErrorId(),className:"slds-form-element__help"},this.labels.error):null))}}])&&g(a.prototype,s),i&&g(a,i),t}(n.a.Component);S.displayName=h.Q,S.propTypes=_,S.defaultProps=y;var E=S;function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e}).apply(this,arguments)}function C(e,t){if(null==e)return{};var a,s,n=function(e,t){if(null==e)return{};var a,s,n={},i=Object.keys(e);for(s=0;s<i.length;s++)a=i[s],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var F={assistiveText:l.a.shape({label:l.a.string}),children:l.a.node.isRequired,className:l.a.oneOfType([l.a.array,l.a.object,l.a.string]),labels:l.a.shape({error:l.a.string,label:l.a.string}),onChange:l.a.func,disabled:l.a.bool,required:l.a.bool,name:l.a.string,errorId:l.a.string},M=function(e){e.variant;var t=C(e,["variant"]);return n.a.createElement(E,k({variant:"button-group"},t))};M.displayName=h.P,M.propTypes=F,M.defaultProps={labels:{},assistiveText:{}};t.a=M}}]);
//# sourceMappingURL=12.a6a15de2.chunk.js.map